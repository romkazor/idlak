<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Kaldi: nnet3/nnet-attention-component.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" href="favicon.ico" type="image/x-icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" /> 
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
 <td id="projectlogo"><a href="http://kaldi-asr.org/"><img alt="Logo" src="KaldiTextAndLogoSmall.png"/ style="padding: 3px 5px 1px 5px"></a></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname" style="display:none">Kaldi
   </div>
  </td>
    <td style="padding-left: 0.5em;">
    <div id="projectbrief" style="display:none"></div>
    </td>
   <!--END PROJECT_BRIEF-->
  <!--END !PROJECT_NAME-->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('nnet-attention-component_8h_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">nnet-attention-component.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="nnet-attention-component_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// nnet3/nnet-attention-component.h</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Copyright      2017  Johns Hopkins University (author: Daniel Povey)</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// See ../../COPYING for clarification regarding multiple authors</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// you may not use this file except in compliance with the License.</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// You may obtain a copy of the License at</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//  http://www.apache.org/licenses/LICENSE-2.0</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// THIS CODE IS PROVIDED *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">// KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">// MERCHANTABLITY OR NON-INFRINGEMENT.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">// See the Apache 2 License for the specific language governing permissions and</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">// limitations under the License.</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#ifndef KALDI_NNET3_NNET_ATTENTION_COMPONENT_H_</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#define KALDI_NNET3_NNET_ATTENTION_COMPONENT_H_</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="nnet-common_8h.html">nnet3/nnet-common.h</a>&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="nnet-component-itf_8h.html">nnet3/nnet-component-itf.h</a>&quot;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="natural-gradient-online_8h.html">nnet3/natural-gradient-online.h</a>&quot;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="attention_8h.html">nnet3/attention.h</a>&quot;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacekaldi.html">kaldi</a> {</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="keyword">namespace </span>nnet3 {</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html">  106</a></span>&#160;<span class="keyword">class </span><a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html">RestrictedAttentionComponent</a>: <span class="keyword">public</span> <a class="code" href="classkaldi_1_1nnet3_1_1Component.html">Component</a> {</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="comment">// The use of this constructor should only precede InitFromConfig()</span></div><div class="line"><a name="l00110"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#aa6b67c244ea18c836e74eed945b46657">  110</a></span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#aa6b67c244ea18c836e74eed945b46657">RestrictedAttentionComponent</a>() { }</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="comment">// Copy constructor</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#aa6b67c244ea18c836e74eed945b46657">RestrictedAttentionComponent</a>(<span class="keyword">const</span> <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html">RestrictedAttentionComponent</a> &amp;other);</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ad4cb6aed1f1980c2c36f34e09ceea0e0">  115</a></span>&#160;  <span class="keyword">virtual</span> int32 <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ad4cb6aed1f1980c2c36f34e09ceea0e0">InputDim</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="comment">// the input is interpreted as being appended blocks one for each head; each</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">// such block is interpreted as (key, value, query).</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    int32 query_dim = <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">key_dim_</a> + <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">context_dim_</a>;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ae53cc4977f9fbe6523374aaf5ba10c80">num_heads_</a> * (<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">key_dim_</a> + <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8fb0e7f13f5d151b88cf0af7a28e6817">value_dim_</a> + query_dim);</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  }</div><div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a323155ad8034c0b14762dd78ae4415b5">  121</a></span>&#160;  <span class="keyword">virtual</span> int32 <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a323155ad8034c0b14762dd78ae4415b5">OutputDim</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="comment">// the output consists of appended blocks, one for each head; each such</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="comment">// block is is the attention weighted average of the input values, to which</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="comment">// we append softmax encoding of the positions we chose, if output_context_</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="comment">// == true.</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ae53cc4977f9fbe6523374aaf5ba10c80">num_heads_</a> * (<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8fb0e7f13f5d151b88cf0af7a28e6817">value_dim_</a> + (<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ac81e565312ceebb6467353ca015ea7d6">output_context_</a> ? <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">context_dim_</a> : 0));</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  }</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keyword">virtual</span> std::string <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a245d65d566725422b859c99bff7623f8">Info</a>() <span class="keyword">const</span>;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ac4f5c35427c2657c50173313e99e3f01">InitFromConfig</a>(<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html">ConfigLine</a> *cfl);</div><div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#af2d951f58073f362411ee482aa469975">  130</a></span>&#160;  <span class="keyword">virtual</span> std::string <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#af2d951f58073f362411ee482aa469975">Type</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="stringliteral">&quot;RestrictedAttentionComponent&quot;</span>; }</div><div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a16a6da3a5108ec53e759722a51fd47">  131</a></span>&#160;  <span class="keyword">virtual</span> int32 <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a16a6da3a5108ec53e759722a51fd47">Properties</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a6c12dbc12f9d02024f66b4b0d160ee67">kReordersIndexes</a>|<a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3adac6588b2ef2e8b52936718cf97263e7">kBackpropNeedsInput</a>|<a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a5180ca55eb0162c68740d51295d056c7">kPropagateAdds</a>|<a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3acda3bbc91bd09631b18fdc57376c2b90">kBackpropAdds</a>|</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3affff5abfeafd5643bee15f1daafe6827">kStoresStats</a>|<a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a1713e609229066c956d4c7d544c69658">kUsesMemo</a>;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  }</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span>* <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f1f1b05a170bd81a544caefe1acb040">Propagate</a>(<span class="keyword">const</span> <a class="code" href="classkaldi_1_1nnet3_1_1ComponentPrecomputedIndexes.html">ComponentPrecomputedIndexes</a> *indexes,</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                         <span class="keyword">const</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> &amp;in,</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                         <a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> *out) <span class="keyword">const</span>;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#acd6c79cbaf8c63ca2e31105dd55bb4ab">StoreStats</a>(<span class="keyword">const</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> &amp;in_value,</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                          <span class="keyword">const</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> &amp;out_value,</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                          <span class="keywordtype">void</span> *memo);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a5a4fc4a0524ae8957baf45b8cb168843">Scale</a>(<a class="code" href="classfloat.html">BaseFloat</a> scale);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#acdb3e97b46276e3c9f4f696c2bef3943">Add</a>(<a class="code" href="classfloat.html">BaseFloat</a> alpha, <span class="keyword">const</span> <a class="code" href="classkaldi_1_1nnet3_1_1Component.html">Component</a> &amp;other);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#abfee972431c5488d69a56fc1114c7cdc">ZeroStats</a>();</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ac0f9bb1c29228fa0a498a19b83ac5190">Backprop</a>(<span class="keyword">const</span> std::string &amp;debug_info,</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                        <span class="keyword">const</span> <a class="code" href="classkaldi_1_1nnet3_1_1ComponentPrecomputedIndexes.html">ComponentPrecomputedIndexes</a> *indexes,</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                        <span class="keyword">const</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> &amp;in_value,</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                        <span class="keyword">const</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> &amp;out_value,</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                        <span class="keyword">const</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> &amp;out_deriv,</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                        <span class="keywordtype">void</span> *memo,</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                        <a class="code" href="classkaldi_1_1nnet3_1_1Component.html">Component</a> *to_update,</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                        <a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> *in_deriv) <span class="keyword">const</span>;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8e7d2790fc7e94fe9780ccc937de1270">Read</a>(std::istream &amp;is, <span class="keywordtype">bool</span> binary);</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a68f354fd5f096134162f01719096e6fc">Write</a>(std::ostream &amp;os, <span class="keywordtype">bool</span> binary) <span class="keyword">const</span>;</div><div class="line"><a name="l00155"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a1de31388e6c4839d855713baedc4f44b">  155</a></span>&#160;  <span class="keyword">virtual</span> <a class="code" href="classkaldi_1_1nnet3_1_1Component.html">Component</a>* <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a1de31388e6c4839d855713baedc4f44b">Copy</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#aa6b67c244ea18c836e74eed945b46657">RestrictedAttentionComponent</a>(*<span class="keyword">this</span>);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  }</div><div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8eacf8174f9fa190732c320ee3cf1d62">  158</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8eacf8174f9fa190732c320ee3cf1d62">DeleteMemo</a>(<span class="keywordtype">void</span> *memo)<span class="keyword"> const </span>{ <span class="keyword">delete</span> <span class="keyword">static_cast&lt;</span><a class="code" href="structkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1Memo.html">Memo</a>*<span class="keyword">&gt;</span>(memo); }</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="comment">// Some functions that are only to be reimplemented for GeneralComponents.</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="comment">// This ReorderIndexes function may insert &#39;blank&#39; indexes (indexes with</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="comment">// t == kNoTime) as well as reordering the indexes.  This is allowed</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="comment">// behavior of ReorderIndexes functions.</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a2133bab2e5e5e64e8136a341971f2012">ReorderIndexes</a>(std::vector&lt;Index&gt; *input_indexes,</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                              std::vector&lt;Index&gt; *output_indexes) <span class="keyword">const</span>;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a9d7b185ac981780bcfaed7dfdd8908d8">GetInputIndexes</a>(<span class="keyword">const</span> <a class="code" href="structkaldi_1_1nnet3_1_1MiscComputationInfo.html">MiscComputationInfo</a> &amp;misc_info,</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                               <span class="keyword">const</span> <a class="code" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &amp;output_index,</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                               std::vector&lt;Index&gt; *desired_indexes) <span class="keyword">const</span>;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="comment">// This function returns true if at least one of the input indexes used to</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="comment">// compute this output index is computable.</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a529c07610dd915a30e452f80b8bb5fc0">IsComputable</a>(<span class="keyword">const</span> <a class="code" href="structkaldi_1_1nnet3_1_1MiscComputationInfo.html">MiscComputationInfo</a> &amp;misc_info,</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                            <span class="keyword">const</span> <a class="code" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &amp;output_index,</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                            <span class="keyword">const</span> <a class="code" href="classkaldi_1_1nnet3_1_1IndexSet.html">IndexSet</a> &amp;input_index_set,</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                            std::vector&lt;Index&gt; *used_inputs) <span class="keyword">const</span>;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keyword">virtual</span> <a class="code" href="classkaldi_1_1nnet3_1_1ComponentPrecomputedIndexes.html">ComponentPrecomputedIndexes</a>* <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8b2919d1c6cfa5f73581f407150374b6">PrecomputeIndexes</a>(</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <span class="keyword">const</span> <a class="code" href="structkaldi_1_1nnet3_1_1MiscComputationInfo.html">MiscComputationInfo</a> &amp;misc_info,</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="keyword">const</span> std::vector&lt;Index&gt; &amp;input_indexes,</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="keyword">const</span> std::vector&lt;Index&gt; &amp;output_indexes,</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      <span class="keywordtype">bool</span> need_backprop) <span class="keyword">const</span>;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1PrecomputedIndexes.html">  185</a></span>&#160;  <span class="keyword">class </span><a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1PrecomputedIndexes.html">PrecomputedIndexes</a>: <span class="keyword">public</span> <a class="code" href="classkaldi_1_1nnet3_1_1ComponentPrecomputedIndexes.html">ComponentPrecomputedIndexes</a> {</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;   <span class="keyword">public</span>:</div><div class="line"><a name="l00187"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1PrecomputedIndexes.html#adb3961d8c7491ff370f6de2ad7af46df">  187</a></span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1PrecomputedIndexes.html#adb3961d8c7491ff370f6de2ad7af46df">PrecomputedIndexes</a>() { }</div><div class="line"><a name="l00188"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1PrecomputedIndexes.html#a354bea029a9d202ce09befa9483438bf">  188</a></span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1PrecomputedIndexes.html#a354bea029a9d202ce09befa9483438bf">PrecomputedIndexes</a>(<span class="keyword">const</span> <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1PrecomputedIndexes.html">PrecomputedIndexes</a> &amp;other):</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1PrecomputedIndexes.html#a6cddba70106ea9202823a99135636cd4">io</a>(other.<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1PrecomputedIndexes.html#a6cddba70106ea9202823a99135636cd4">io</a>) { }</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keyword">virtual</span> <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1PrecomputedIndexes.html">PrecomputedIndexes</a> *<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1PrecomputedIndexes.html#ad884de0beb42fcd394aa69aade48b16e">Copy</a>() <span class="keyword">const</span>;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1PrecomputedIndexes.html#a68f354fd5f096134162f01719096e6fc">Write</a>(std::ostream &amp;os, <span class="keywordtype">bool</span> binary) <span class="keyword">const</span>;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1PrecomputedIndexes.html#ae2892c501e401b523a3eb774e735d64d">Read</a>(std::istream &amp;os, <span class="keywordtype">bool</span> binary);</div><div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1PrecomputedIndexes.html#af2d951f58073f362411ee482aa469975">  193</a></span>&#160;    <span class="keyword">virtual</span> std::string <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1PrecomputedIndexes.html#af2d951f58073f362411ee482aa469975">Type</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;RestrictedAttentionComponentPrecomputedIndexes&quot;</span>;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    }</div><div class="line"><a name="l00196"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1PrecomputedIndexes.html#a89d3bf5e1f2f92751f6080a2d39e8c3d">  196</a></span>&#160;    <span class="keyword">virtual</span> <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1PrecomputedIndexes.html#a89d3bf5e1f2f92751f6080a2d39e8c3d">~PrecomputedIndexes</a>() { }</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1PrecomputedIndexes.html#a6cddba70106ea9202823a99135636cd4">  198</a></span>&#160;    <a class="code" href="structkaldi_1_1nnet3_1_1time__height__convolution_1_1ConvolutionComputationIo.html">time_height_convolution::ConvolutionComputationIo</a> <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1PrecomputedIndexes.html#a6cddba70106ea9202823a99135636cd4">io</a>;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  };</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="comment">// This is what&#39;s returned as the &#39;memo&#39; from the Propagate() function.</span></div><div class="line"><a name="l00202"></a><span class="lineno"><a class="line" href="structkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1Memo.html">  202</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1Memo.html">Memo</a> {</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">// c is of dimension (num_heads_ * num-output-frames) by context_dim_,</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="comment">// where num-output-frames is the number of frames of output the</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">// corresponding Propagate function produces.</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">// Each block of &#39;num-output-frames&#39; rows of c_t is the</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">// post-softmax matrix of weights.</span></div><div class="line"><a name="l00208"></a><span class="lineno"><a class="line" href="structkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1Memo.html#abd910b9c6c1b066127336f154f20adac">  208</a></span>&#160;    <a class="code" href="classkaldi_1_1CuMatrix.html">CuMatrix&lt;BaseFloat&gt;</a> <a class="code" href="structkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1Memo.html#abd910b9c6c1b066127336f154f20adac">c</a>;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  };</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="comment">// Does the propagation for one head; this is called for each</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="comment">// head by the top-level Propagate function.  Later on we may</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="comment">// figure out a way to avoid doing this sequentially.</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="comment">// &#39;in&#39; and &#39;out&#39; are submatrices of the &#39;in&#39; and &#39;out&#39; passed</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="comment">// to the top-level Propagate function, and &#39;c&#39; is a submatrix</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="comment">// of the &#39;c&#39; matrix in the memo we&#39;re creating.</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="comment">// Assumes &#39;c&#39; has already been zerooed.</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a7493d5942eae2b80fceab01dd8bbff16">PropagateOneHead</a>(</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <span class="keyword">const</span> <a class="code" href="structkaldi_1_1nnet3_1_1time__height__convolution_1_1ConvolutionComputationIo.html">time_height_convolution::ConvolutionComputationIo</a> &amp;<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1PrecomputedIndexes.html#a6cddba70106ea9202823a99135636cd4">io</a>,</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      <span class="keyword">const</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> &amp;in,</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      <a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> *c,</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      <a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> *out) <span class="keyword">const</span>;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="comment">// does the backprop for one head; called by Backprop().</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a37fc34ec7c7ab80d54c88e84a12d38e0">BackpropOneHead</a>(</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <span class="keyword">const</span> <a class="code" href="structkaldi_1_1nnet3_1_1time__height__convolution_1_1ConvolutionComputationIo.html">time_height_convolution::ConvolutionComputationIo</a> &amp;<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1PrecomputedIndexes.html#a6cddba70106ea9202823a99135636cd4">io</a>,</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <span class="keyword">const</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> &amp;in_value,</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      <span class="keyword">const</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> &amp;c,</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <span class="keyword">const</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> &amp;out_deriv,</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> *in_deriv) <span class="keyword">const</span>;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="comment">// This function, used in ReorderIndexes() and PrecomputedIndexes(),</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="comment">// works out what grid structure over time we will have at the input</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="comment">// and the output.</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="comment">// Note: it may produce a grid that encompasses more than what was</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="comment">// listed in &#39;input_indexes&#39; and &#39;output_indexes&#39;.  This is OK.</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="comment">// ReorderIndexes() will add placeholders with t == kNoTime for</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="comment">// padding, and at the input of this component those placeholders</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="comment">// will be zero; at the output the placeholders will be ignored.</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a38367562a48aa99e77d5d2f6eded46c1">GetComputationStructure</a>(</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <span class="keyword">const</span> std::vector&lt;Index&gt; &amp;input_indexes,</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      <span class="keyword">const</span> std::vector&lt;Index&gt; &amp;output_indexes,</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      <a class="code" href="structkaldi_1_1nnet3_1_1time__height__convolution_1_1ConvolutionComputationIo.html">time_height_convolution::ConvolutionComputationIo</a> *<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1PrecomputedIndexes.html#a6cddba70106ea9202823a99135636cd4">io</a>) <span class="keyword">const</span>;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="comment">// This function, used in ReorderIndexes(), obtains the indexes with the</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="comment">// correct structure and order (the structure is specified in the &#39;io&#39; object.</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="comment">// This may involve not just reordering the provided indexes, but padding them</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="comment">// with indexes that have kNoTime as the time.</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="comment">// Basically the indexes this function outputs form a grid where &#39;t&#39; has the</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <span class="comment">// larger stride than the (n, x) pairs.   The number of distinct (n, x) pairs</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="comment">// should equal io.num_images.  Where &#39;t&#39; values need to appear in the</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="comment">// new indexes that were not present in the old indexes, they get replaced with</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="comment">// kNoTime.</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#afc71d7740bea7e0050f7ece2f3d575eb">GetIndexes</a>(</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      <span class="keyword">const</span> std::vector&lt;Index&gt; &amp;input_indexes,</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      <span class="keyword">const</span> std::vector&lt;Index&gt; &amp;output_indexes,</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      <a class="code" href="structkaldi_1_1nnet3_1_1time__height__convolution_1_1ConvolutionComputationIo.html">time_height_convolution::ConvolutionComputationIo</a> &amp;<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1PrecomputedIndexes.html#a6cddba70106ea9202823a99135636cd4">io</a>,</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      std::vector&lt;Index&gt; *new_input_indexes,</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      std::vector&lt;Index&gt; *new_output_indexes) <span class="keyword">const</span>;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a91eb639e00c2eafa02815a750be70f8a">CreateIndexesVector</a>(</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <span class="keyword">const</span> std::vector&lt;std::pair&lt;int32, int32&gt; &gt; &amp;n_x_pairs,</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      int32 t_start, int32 t_step, int32 num_t_values,</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      <span class="keyword">const</span> std::unordered_set&lt;Index, IndexHasher&gt; &amp;index_set,</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      std::vector&lt;Index&gt; *output_indexes);</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4c47fd4f163011eb1939870d25aa656a">Check</a>() <span class="keyword">const</span>;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ae53cc4977f9fbe6523374aaf5ba10c80">  281</a></span>&#160;  int32 <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ae53cc4977f9fbe6523374aaf5ba10c80">num_heads_</a>;</div><div class="line"><a name="l00282"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">  282</a></span>&#160;  int32 <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">key_dim_</a>;</div><div class="line"><a name="l00283"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8fb0e7f13f5d151b88cf0af7a28e6817">  283</a></span>&#160;  int32 <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8fb0e7f13f5d151b88cf0af7a28e6817">value_dim_</a>;</div><div class="line"><a name="l00284"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4d7e5406fed09929350deb26767f25aa">  284</a></span>&#160;  int32 <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4d7e5406fed09929350deb26767f25aa">num_left_inputs_</a>;</div><div class="line"><a name="l00285"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40571f26e91bce91b89f63840291c8ce">  285</a></span>&#160;  int32 <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40571f26e91bce91b89f63840291c8ce">num_right_inputs_</a>;</div><div class="line"><a name="l00286"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a43d674ac6ba436481c1c4672fd1bea77">  286</a></span>&#160;  int32 <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a43d674ac6ba436481c1c4672fd1bea77">time_stride_</a>;</div><div class="line"><a name="l00287"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">  287</a></span>&#160;  int32 <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">context_dim_</a>;  <span class="comment">// This derived parameter equals 1 + num_left_inputs_ +</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                       <span class="comment">// num_right_inputs_.</span></div><div class="line"><a name="l00289"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a0e898f815954c8234cc4c17527168eb9">  289</a></span>&#160;  int32 <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a0e898f815954c8234cc4c17527168eb9">num_left_inputs_required_</a>;</div><div class="line"><a name="l00290"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a2d9705afdedc78fc1e64957f976085d0">  290</a></span>&#160;  int32 <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a2d9705afdedc78fc1e64957f976085d0">num_right_inputs_required_</a>;</div><div class="line"><a name="l00291"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ac81e565312ceebb6467353ca015ea7d6">  291</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ac81e565312ceebb6467353ca015ea7d6">output_context_</a>;</div><div class="line"><a name="l00292"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#acee63c613b77d9037649008e094ad585">  292</a></span>&#160;  <a class="code" href="classfloat.html">BaseFloat</a> <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#acee63c613b77d9037649008e094ad585">key_scale_</a>;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div><div class="line"><a name="l00294"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a17d0f37c99e964fc99274cf984f383e8">  294</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a17d0f37c99e964fc99274cf984f383e8">stats_count_</a>;  <span class="comment">// Count of frames corresponding to the stats.</span></div><div class="line"><a name="l00295"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40a34aecd5f5f9754cf84d41be5375c0">  295</a></span>&#160;  <a class="code" href="classkaldi_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40a34aecd5f5f9754cf84d41be5375c0">entropy_stats_</a>;  <span class="comment">// entropy stats, indexed per head.</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                                  <span class="comment">// (dimension is num_heads_).  Divide</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                                  <span class="comment">// by stats_count_ to normalize.</span></div><div class="line"><a name="l00298"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a1cfb68dbd140132e24fa5ede76562e45">  298</a></span>&#160;  <a class="code" href="classkaldi_1_1CuMatrix.html">CuMatrix&lt;double&gt;</a> <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a1cfb68dbd140132e24fa5ede76562e45">posterior_stats_</a>;  <span class="comment">// stats of posteriors of different</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                                      <span class="comment">// offsets, of dimension num_heads_ *</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                                      <span class="comment">// context_dim_ (num-heads has the</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                                      <span class="comment">// larger stride).</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;};</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;} <span class="comment">// namespace nnet3</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;} <span class="comment">// namespace kaldi</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="preprocessor">#endif</span></div><div class="ttc" id="namespacekaldi_html"><div class="ttname"><a href="namespacekaldi.html">kaldi</a></div><div class="ttdoc">Relabels neural network egs with the read pdf-id alignments. </div><div class="ttdef"><b>Definition:</b> <a href="chain_8dox_source.html#l00020">chain.dox:20</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_afc71d7740bea7e0050f7ece2f3d575eb"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#afc71d7740bea7e0050f7ece2f3d575eb">kaldi::nnet3::RestrictedAttentionComponent::GetIndexes</a></div><div class="ttdeci">void GetIndexes(const std::vector&lt; Index &gt; &amp;input_indexes, const std::vector&lt; Index &gt; &amp;output_indexes, time_height_convolution::ConvolutionComputationIo &amp;io, std::vector&lt; Index &gt; *new_input_indexes, std::vector&lt; Index &gt; *new_output_indexes) const</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8cc_source.html#l00596">nnet-attention-component.cc:596</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_acdb3e97b46276e3c9f4f696c2bef3943"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#acdb3e97b46276e3c9f4f696c2bef3943">kaldi::nnet3::RestrictedAttentionComponent::Add</a></div><div class="ttdeci">virtual void Add(BaseFloat alpha, const Component &amp;other)</div><div class="ttdoc">This virtual function when called by  an UpdatableComponent adds the parameters of another updatabl...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8cc_source.html#l00261">nnet-attention-component.cc:261</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a38367562a48aa99e77d5d2f6eded46c1"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a38367562a48aa99e77d5d2f6eded46c1">kaldi::nnet3::RestrictedAttentionComponent::GetComputationStructure</a></div><div class="ttdeci">void GetComputationStructure(const std::vector&lt; Index &gt; &amp;input_indexes, const std::vector&lt; Index &gt; &amp;output_indexes, time_height_convolution::ConvolutionComputationIo *io) const</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8cc_source.html#l00388">nnet-attention-component.cc:388</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_ad4cb6aed1f1980c2c36f34e09ceea0e0"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ad4cb6aed1f1980c2c36f34e09ceea0e0">kaldi::nnet3::RestrictedAttentionComponent::InputDim</a></div><div class="ttdeci">virtual int32 InputDim() const</div><div class="ttdoc">Returns input-dimension of this component. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00115">nnet-attention-component.h:115</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_acee63c613b77d9037649008e094ad585"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#acee63c613b77d9037649008e094ad585">kaldi::nnet3::RestrictedAttentionComponent::key_scale_</a></div><div class="ttdeci">BaseFloat key_scale_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00292">nnet-attention-component.h:292</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a4c47fd4f163011eb1939870d25aa656a"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4c47fd4f163011eb1939870d25aa656a">kaldi::nnet3::RestrictedAttentionComponent::Check</a></div><div class="ttdeci">void Check() const</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8cc_source.html#l00277">nnet-attention-component.cc:277</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a8e7d2790fc7e94fe9780ccc937de1270"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8e7d2790fc7e94fe9780ccc937de1270">kaldi::nnet3::RestrictedAttentionComponent::Read</a></div><div class="ttdeci">virtual void Read(std::istream &amp;is, bool binary)</div><div class="ttdoc">Read function (used after we know the type of the Component); accepts input that is missing the token...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8cc_source.html#l00472">nnet-attention-component.cc:472</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a43d674ac6ba436481c1c4672fd1bea77"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a43d674ac6ba436481c1c4672fd1bea77">kaldi::nnet3::RestrictedAttentionComponent::time_stride_</a></div><div class="ttdeci">int32 time_stride_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00286">nnet-attention-component.h:286</a></div></div>
<div class="ttc" id="nnet-component-itf_8h_html"><div class="ttname"><a href="nnet-component-itf_8h.html">nnet-component-itf.h</a></div></div>
<div class="ttc" id="nnet-common_8h_html"><div class="ttname"><a href="nnet-common_8h.html">nnet-common.h</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ConfigLine_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ConfigLine.html">kaldi::nnet3::ConfigLine</a></div><div class="ttdoc">This class is responsible for parsing input like hi-there xx=yyy a=b c empty= f-oo=Append(bar, sss) ba_z=123 bing=&amp;#39;a b c&amp;#39; baz=&quot;a b c d=&amp;#39;a b&amp;#39; e&quot; and giving you access to the fields, in this case. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-parse_8h_source.html#l00048">nnet-parse.h:48</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html">kaldi::nnet3::Component</a></div><div class="ttdoc">Abstract base-class for neural-net components. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00114">nnet-component-itf.h:114</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a1de31388e6c4839d855713baedc4f44b"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a1de31388e6c4839d855713baedc4f44b">kaldi::nnet3::RestrictedAttentionComponent::Copy</a></div><div class="ttdeci">virtual Component * Copy() const</div><div class="ttdoc">Copies component (deep copy). </div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00155">nnet-attention-component.h:155</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3a1713e609229066c956d4c7d544c69658"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a1713e609229066c956d4c7d544c69658">kaldi::nnet3::kUsesMemo</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00079">nnet-component-itf.h:79</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1IndexSet_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1IndexSet.html">kaldi::nnet3::IndexSet</a></div><div class="ttdoc">An abstract representation of a set of Indexes. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8h_source.html#l00321">nnet-computation-graph.h:321</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1PrecomputedIndexes_html_a354bea029a9d202ce09befa9483438bf"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1PrecomputedIndexes.html#a354bea029a9d202ce09befa9483438bf">kaldi::nnet3::RestrictedAttentionComponent::PrecomputedIndexes::PrecomputedIndexes</a></div><div class="ttdeci">PrecomputedIndexes(const PrecomputedIndexes &amp;other)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00188">nnet-attention-component.h:188</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a0e898f815954c8234cc4c17527168eb9"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a0e898f815954c8234cc4c17527168eb9">kaldi::nnet3::RestrictedAttentionComponent::num_left_inputs_required_</a></div><div class="ttdeci">int32 num_left_inputs_required_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00289">nnet-attention-component.h:289</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a37fc34ec7c7ab80d54c88e84a12d38e0"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a37fc34ec7c7ab80d54c88e84a12d38e0">kaldi::nnet3::RestrictedAttentionComponent::BackpropOneHead</a></div><div class="ttdeci">void BackpropOneHead(const time_height_convolution::ConvolutionComputationIo &amp;io, const CuMatrixBase&lt; BaseFloat &gt; &amp;in_value, const CuMatrixBase&lt; BaseFloat &gt; &amp;c, const CuMatrixBase&lt; BaseFloat &gt; &amp;out_deriv, CuMatrixBase&lt; BaseFloat &gt; *in_deriv) const</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8cc_source.html#l00334">nnet-attention-component.cc:334</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_ac81e565312ceebb6467353ca015ea7d6"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ac81e565312ceebb6467353ca015ea7d6">kaldi::nnet3::RestrictedAttentionComponent::output_context_</a></div><div class="ttdeci">bool output_context_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00291">nnet-attention-component.h:291</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a91eb639e00c2eafa02815a750be70f8a"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a91eb639e00c2eafa02815a750be70f8a">kaldi::nnet3::RestrictedAttentionComponent::CreateIndexesVector</a></div><div class="ttdeci">static void CreateIndexesVector(const std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &amp;n_x_pairs, int32 t_start, int32 t_step, int32 num_t_values, const std::unordered_set&lt; Index, IndexHasher &gt; &amp;index_set, std::vector&lt; Index &gt; *output_indexes)</div><div class="ttdoc">Utility function used in GetIndexes(). </div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8cc_source.html#l00574">nnet-attention-component.cc:574</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrix_html"><div class="ttname"><a href="classkaldi_1_1CuMatrix.html">kaldi::CuMatrix</a></div><div class="ttdoc">This class represents a matrix that&amp;#39;s stored on the GPU if we have one, and in memory if not...</div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00071">matrix-common.h:71</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1MiscComputationInfo_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1MiscComputationInfo.html">kaldi::nnet3::MiscComputationInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00055">nnet-computation.h:55</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a529c07610dd915a30e452f80b8bb5fc0"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a529c07610dd915a30e452f80b8bb5fc0">kaldi::nnet3::RestrictedAttentionComponent::IsComputable</a></div><div class="ttdeci">virtual bool IsComputable(const MiscComputationInfo &amp;misc_info, const Index &amp;output_index, const IndexSet &amp;input_index_set, std::vector&lt; Index &gt; *used_inputs) const</div><div class="ttdoc">This function only does something interesting for non-simple Components, and it exists to make it pos...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8cc_source.html#l00526">nnet-attention-component.cc:526</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_aa6b67c244ea18c836e74eed945b46657"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#aa6b67c244ea18c836e74eed945b46657">kaldi::nnet3::RestrictedAttentionComponent::RestrictedAttentionComponent</a></div><div class="ttdeci">RestrictedAttentionComponent()</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00110">nnet-attention-component.h:110</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a2d9705afdedc78fc1e64957f976085d0"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a2d9705afdedc78fc1e64957f976085d0">kaldi::nnet3::RestrictedAttentionComponent::num_right_inputs_required_</a></div><div class="ttdeci">int32 num_right_inputs_required_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00290">nnet-attention-component.h:290</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a1cfb68dbd140132e24fa5ede76562e45"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a1cfb68dbd140132e24fa5ede76562e45">kaldi::nnet3::RestrictedAttentionComponent::posterior_stats_</a></div><div class="ttdeci">CuMatrix&lt; double &gt; posterior_stats_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00298">nnet-attention-component.h:298</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a323155ad8034c0b14762dd78ae4415b5"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a323155ad8034c0b14762dd78ae4415b5">kaldi::nnet3::RestrictedAttentionComponent::OutputDim</a></div><div class="ttdeci">virtual int32 OutputDim() const</div><div class="ttdoc">Returns output-dimension of this component. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00121">nnet-attention-component.h:121</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_ac0f9bb1c29228fa0a498a19b83ac5190"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ac0f9bb1c29228fa0a498a19b83ac5190">kaldi::nnet3::RestrictedAttentionComponent::Backprop</a></div><div class="ttdeci">virtual void Backprop(const std::string &amp;debug_info, const ComponentPrecomputedIndexes *indexes, const CuMatrixBase&lt; BaseFloat &gt; &amp;in_value, const CuMatrixBase&lt; BaseFloat &gt; &amp;out_value, const CuMatrixBase&lt; BaseFloat &gt; &amp;out_deriv, void *memo, Component *to_update, CuMatrixBase&lt; BaseFloat &gt; *in_deriv) const</div><div class="ttdoc">Backprop function; depending on which of the arguments &amp;#39;to_update&amp;#39; and &amp;#39;in_deriv&amp;#39; are non-NULL...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8cc_source.html#l00292">nnet-attention-component.cc:292</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1PrecomputedIndexes_html_ad884de0beb42fcd394aa69aade48b16e"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1PrecomputedIndexes.html#ad884de0beb42fcd394aa69aade48b16e">kaldi::nnet3::RestrictedAttentionComponent::PrecomputedIndexes::Copy</a></div><div class="ttdeci">virtual PrecomputedIndexes * Copy() const</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8cc_source.html#l00648">nnet-attention-component.cc:648</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1PrecomputedIndexes_html_a6cddba70106ea9202823a99135636cd4"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1PrecomputedIndexes.html#a6cddba70106ea9202823a99135636cd4">kaldi::nnet3::RestrictedAttentionComponent::PrecomputedIndexes::io</a></div><div class="ttdeci">time_height_convolution::ConvolutionComputationIo io</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00198">nnet-attention-component.h:198</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a8eacf8174f9fa190732c320ee3cf1d62"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8eacf8174f9fa190732c320ee3cf1d62">kaldi::nnet3::RestrictedAttentionComponent::DeleteMemo</a></div><div class="ttdeci">virtual void DeleteMemo(void *memo) const</div><div class="ttdoc">This virtual function only needs to be overwritten by Components that return a non-NULL memo from the...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00158">nnet-attention-component.h:158</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a40571f26e91bce91b89f63840291c8ce"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40571f26e91bce91b89f63840291c8ce">kaldi::nnet3::RestrictedAttentionComponent::num_right_inputs_</a></div><div class="ttdeci">int32 num_right_inputs_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00285">nnet-attention-component.h:285</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1Index_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1Index.html">kaldi::nnet3::Index</a></div><div class="ttdoc">struct Index is intended to represent the various indexes by which we number the rows of the matrices...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-common_8h_source.html#l00044">nnet-common.h:44</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a5a4fc4a0524ae8957baf45b8cb168843"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a5a4fc4a0524ae8957baf45b8cb168843">kaldi::nnet3::RestrictedAttentionComponent::Scale</a></div><div class="ttdeci">virtual void Scale(BaseFloat scale)</div><div class="ttdoc">This virtual function when called on  an UpdatableComponent scales the parameters by &quot;scale&quot; when c...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8cc_source.html#l00255">nnet-attention-component.cc:255</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a40a34aecd5f5f9754cf84d41be5375c0"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40a34aecd5f5f9754cf84d41be5375c0">kaldi::nnet3::RestrictedAttentionComponent::entropy_stats_</a></div><div class="ttdeci">Vector&lt; double &gt; entropy_stats_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00295">nnet-attention-component.h:295</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_ac4f5c35427c2657c50173313e99e3f01"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ac4f5c35427c2657c50173313e99e3f01">kaldi::nnet3::RestrictedAttentionComponent::InitFromConfig</a></div><div class="ttdeci">virtual void InitFromConfig(ConfigLine *cfl)</div><div class="ttdoc">Initialize, from a ConfigLine object. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8cc_source.html#l00080">nnet-attention-component.cc:80</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a4a638e2d2a390900749819b63b06cba8"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">kaldi::nnet3::RestrictedAttentionComponent::key_dim_</a></div><div class="ttdeci">int32 key_dim_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00282">nnet-attention-component.h:282</a></div></div>
<div class="ttc" id="classfloat_html"><div class="ttname"><a href="classfloat.html">float</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a17d0f37c99e964fc99274cf984f383e8"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a17d0f37c99e964fc99274cf984f383e8">kaldi::nnet3::RestrictedAttentionComponent::stats_count_</a></div><div class="ttdeci">double stats_count_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00294">nnet-attention-component.h:294</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1Memo_html_abd910b9c6c1b066127336f154f20adac"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1Memo.html#abd910b9c6c1b066127336f154f20adac">kaldi::nnet3::RestrictedAttentionComponent::Memo::c</a></div><div class="ttdeci">CuMatrix&lt; BaseFloat &gt; c</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00208">nnet-attention-component.h:208</a></div></div>
<div class="ttc" id="natural-gradient-online_8h_html"><div class="ttname"><a href="natural-gradient-online_8h.html">natural-gradient-online.h</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a8b2919d1c6cfa5f73581f407150374b6"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8b2919d1c6cfa5f73581f407150374b6">kaldi::nnet3::RestrictedAttentionComponent::PrecomputeIndexes</a></div><div class="ttdeci">virtual ComponentPrecomputedIndexes * PrecomputeIndexes(const MiscComputationInfo &amp;misc_info, const std::vector&lt; Index &gt; &amp;input_indexes, const std::vector&lt; Index &gt; &amp;output_indexes, bool need_backprop) const</div><div class="ttdoc">This function must return NULL for simple Components. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8cc_source.html#l00621">nnet-attention-component.cc:621</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_af2d951f58073f362411ee482aa469975"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#af2d951f58073f362411ee482aa469975">kaldi::nnet3::RestrictedAttentionComponent::Type</a></div><div class="ttdeci">virtual std::string Type() const</div><div class="ttdoc">Returns a string such as &quot;SigmoidComponent&quot;, describing the type of the object. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00130">nnet-attention-component.h:130</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3affff5abfeafd5643bee15f1daafe6827"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3affff5abfeafd5643bee15f1daafe6827">kaldi::nnet3::kStoresStats</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00071">nnet-component-itf.h:71</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a8fb0e7f13f5d151b88cf0af7a28e6817"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8fb0e7f13f5d151b88cf0af7a28e6817">kaldi::nnet3::RestrictedAttentionComponent::value_dim_</a></div><div class="ttdeci">int32 value_dim_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00283">nnet-attention-component.h:283</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3adac6588b2ef2e8b52936718cf97263e7"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3adac6588b2ef2e8b52936718cf97263e7">kaldi::nnet3::kBackpropNeedsInput</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00065">nnet-component-itf.h:65</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_abfee972431c5488d69a56fc1114c7cdc"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#abfee972431c5488d69a56fc1114c7cdc">kaldi::nnet3::RestrictedAttentionComponent::ZeroStats</a></div><div class="ttdeci">virtual void ZeroStats()</div><div class="ttdoc">Components that provide an implementation of StoreStats should also provide an implementation of Zero...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8cc_source.html#l00249">nnet-attention-component.cc:249</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a9d7b185ac981780bcfaed7dfdd8908d8"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a9d7b185ac981780bcfaed7dfdd8908d8">kaldi::nnet3::RestrictedAttentionComponent::GetInputIndexes</a></div><div class="ttdeci">virtual void GetInputIndexes(const MiscComputationInfo &amp;misc_info, const Index &amp;output_index, std::vector&lt; Index &gt; *desired_indexes) const</div><div class="ttdoc">This function only does something interesting for non-simple Components. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8cc_source.html#l00506">nnet-attention-component.cc:506</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1PrecomputedIndexes_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1PrecomputedIndexes.html">kaldi::nnet3::RestrictedAttentionComponent::PrecomputedIndexes</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00185">nnet-attention-component.h:185</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3a5180ca55eb0162c68740d51295d056c7"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a5180ca55eb0162c68740d51295d056c7">kaldi::nnet3::kPropagateAdds</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00053">nnet-component-itf.h:53</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a245d65d566725422b859c99bff7623f8"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a245d65d566725422b859c99bff7623f8">kaldi::nnet3::RestrictedAttentionComponent::Info</a></div><div class="ttdeci">virtual std::string Info() const</div><div class="ttdoc">Returns some text-form information about this component, for diagnostics. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8cc_source.html#l00032">nnet-attention-component.cc:32</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1PrecomputedIndexes_html_af2d951f58073f362411ee482aa469975"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1PrecomputedIndexes.html#af2d951f58073f362411ee482aa469975">kaldi::nnet3::RestrictedAttentionComponent::PrecomputedIndexes::Type</a></div><div class="ttdeci">virtual std::string Type() const</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00193">nnet-attention-component.h:193</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a8f2ba24a43264b8812e3e1e83878a59c"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">kaldi::nnet3::RestrictedAttentionComponent::context_dim_</a></div><div class="ttdeci">int32 context_dim_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00287">nnet-attention-component.h:287</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a8f1f1b05a170bd81a544caefe1acb040"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f1f1b05a170bd81a544caefe1acb040">kaldi::nnet3::RestrictedAttentionComponent::Propagate</a></div><div class="ttdeci">virtual void * Propagate(const ComponentPrecomputedIndexes *indexes, const CuMatrixBase&lt; BaseFloat &gt; &amp;in, CuMatrixBase&lt; BaseFloat &gt; *out) const</div><div class="ttdoc">Propagate function. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8cc_source.html#l00132">nnet-attention-component.cc:132</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a68f354fd5f096134162f01719096e6fc"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a68f354fd5f096134162f01719096e6fc">kaldi::nnet3::RestrictedAttentionComponent::Write</a></div><div class="ttdeci">virtual void Write(std::ostream &amp;os, bool binary) const</div><div class="ttdoc">Write component to stream. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8cc_source.html#l00441">nnet-attention-component.cc:441</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1Memo_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1Memo.html">kaldi::nnet3::RestrictedAttentionComponent::Memo</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00202">nnet-attention-component.h:202</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1PrecomputedIndexes_html_ae2892c501e401b523a3eb774e735d64d"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1PrecomputedIndexes.html#ae2892c501e401b523a3eb774e735d64d">kaldi::nnet3::RestrictedAttentionComponent::PrecomputedIndexes::Read</a></div><div class="ttdeci">virtual void Read(std::istream &amp;os, bool binary)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8cc_source.html#l00660">nnet-attention-component.cc:660</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a2133bab2e5e5e64e8136a341971f2012"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a2133bab2e5e5e64e8136a341971f2012">kaldi::nnet3::RestrictedAttentionComponent::ReorderIndexes</a></div><div class="ttdeci">virtual void ReorderIndexes(std::vector&lt; Index &gt; *input_indexes, std::vector&lt; Index &gt; *output_indexes) const</div><div class="ttdoc">This function only does something interesting for non-simple Components. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8cc_source.html#l00375">nnet-attention-component.cc:375</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1time__height__convolution_1_1ConvolutionComputationIo_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1time__height__convolution_1_1ConvolutionComputationIo.html">kaldi::nnet3::time_height_convolution::ConvolutionComputationIo</a></div><div class="ttdef"><b>Definition:</b> <a href="convolution_8h_source.html#l00380">convolution.h:380</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3a6c12dbc12f9d02024f66b4b0d160ee67"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a6c12dbc12f9d02024f66b4b0d160ee67">kaldi::nnet3::kReordersIndexes</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00058">nnet-component-itf.h:58</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html">kaldi::CuMatrixBase</a></div><div class="ttdoc">Matrix for CUDA computing. </div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00069">matrix-common.h:69</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3acda3bbc91bd09631b18fdc57376c2b90"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3acda3bbc91bd09631b18fdc57376c2b90">kaldi::nnet3::kBackpropAdds</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00061">nnet-component-itf.h:61</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ComponentPrecomputedIndexes_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComponentPrecomputedIndexes.html">kaldi::nnet3::ComponentPrecomputedIndexes</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00097">nnet-component-itf.h:97</a></div></div>
<div class="ttc" id="classkaldi_1_1Vector_html"><div class="ttname"><a href="classkaldi_1_1Vector.html">kaldi::Vector&lt; double &gt;</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html">kaldi::nnet3::RestrictedAttentionComponent</a></div><div class="ttdoc">RestrictedAttentionComponent implements an attention model with restricted temporal context...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00106">nnet-attention-component.h:106</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1PrecomputedIndexes_html_a89d3bf5e1f2f92751f6080a2d39e8c3d"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1PrecomputedIndexes.html#a89d3bf5e1f2f92751f6080a2d39e8c3d">kaldi::nnet3::RestrictedAttentionComponent::PrecomputedIndexes::~PrecomputedIndexes</a></div><div class="ttdeci">virtual ~PrecomputedIndexes()</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00196">nnet-attention-component.h:196</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1PrecomputedIndexes_html_a68f354fd5f096134162f01719096e6fc"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1PrecomputedIndexes.html#a68f354fd5f096134162f01719096e6fc">kaldi::nnet3::RestrictedAttentionComponent::PrecomputedIndexes::Write</a></div><div class="ttdeci">virtual void Write(std::ostream &amp;os, bool binary) const</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8cc_source.html#l00652">nnet-attention-component.cc:652</a></div></div>
<div class="ttc" id="attention_8h_html"><div class="ttname"><a href="attention_8h.html">attention.h</a></div><div class="ttdoc">This file contains the lower-level interface for self-attention. </div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a4a16a6da3a5108ec53e759722a51fd47"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a16a6da3a5108ec53e759722a51fd47">kaldi::nnet3::RestrictedAttentionComponent::Properties</a></div><div class="ttdeci">virtual int32 Properties() const</div><div class="ttdoc">Return bitmask of the component&amp;#39;s properties. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00131">nnet-attention-component.h:131</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a7493d5942eae2b80fceab01dd8bbff16"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a7493d5942eae2b80fceab01dd8bbff16">kaldi::nnet3::RestrictedAttentionComponent::PropagateOneHead</a></div><div class="ttdeci">void PropagateOneHead(const time_height_convolution::ConvolutionComputationIo &amp;io, const CuMatrixBase&lt; BaseFloat &gt; &amp;in, CuMatrixBase&lt; BaseFloat &gt; *c, CuMatrixBase&lt; BaseFloat &gt; *out) const</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8cc_source.html#l00160">nnet-attention-component.cc:160</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_acd6c79cbaf8c63ca2e31105dd55bb4ab"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#acd6c79cbaf8c63ca2e31105dd55bb4ab">kaldi::nnet3::RestrictedAttentionComponent::StoreStats</a></div><div class="ttdeci">virtual void StoreStats(const CuMatrixBase&lt; BaseFloat &gt; &amp;in_value, const CuMatrixBase&lt; BaseFloat &gt; &amp;out_value, void *memo)</div><div class="ttdoc">This function may store stats on average activation values, and for some component types...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8cc_source.html#l00200">nnet-attention-component.cc:200</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_ae53cc4977f9fbe6523374aaf5ba10c80"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ae53cc4977f9fbe6523374aaf5ba10c80">kaldi::nnet3::RestrictedAttentionComponent::num_heads_</a></div><div class="ttdeci">int32 num_heads_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00281">nnet-attention-component.h:281</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1PrecomputedIndexes_html_adb3961d8c7491ff370f6de2ad7af46df"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1PrecomputedIndexes.html#adb3961d8c7491ff370f6de2ad7af46df">kaldi::nnet3::RestrictedAttentionComponent::PrecomputedIndexes::PrecomputedIndexes</a></div><div class="ttdeci">PrecomputedIndexes()</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00187">nnet-attention-component.h:187</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a4d7e5406fed09929350deb26767f25aa"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4d7e5406fed09929350deb26767f25aa">kaldi::nnet3::RestrictedAttentionComponent::num_left_inputs_</a></div><div class="ttdeci">int32 num_left_inputs_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00284">nnet-attention-component.h:284</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_67a0a17020b8eedc08ffa5626b1d53a1.html">nnet3</a></li><li class="navelem"><a class="el" href="nnet-attention-component_8h.html">nnet-attention-component.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
