<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Kaldi: The Kaldi Matrix library</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" href="favicon.ico" type="image/x-icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" /> 
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
 <td id="projectlogo"><a href="http://kaldi-asr.org/"><img alt="Logo" src="KaldiTextAndLogoSmall.png"/ style="padding: 3px 5px 1px 5px"></a></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname" style="display:none">Kaldi
   </div>
  </td>
    <td style="padding-left: 0.5em;">
    <div id="projectbrief" style="display:none"></div>
    </td>
   <!--END PROJECT_BRIEF-->
  <!--END !PROJECT_NAME-->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('matrix.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">The Kaldi <a class="el" href="classkaldi_1_1Matrix.html" title="A class for storing matrices. ">Matrix</a> library </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The Kaldi matrix library is mostly a C++ wrapper for standard BLAS and LAPACK linear algebra routines.</p>
<p>This documentation page provides an overview of how to use the library. See <a class="el" href="group__matrix__group.html">Matrix and vector classes</a> for code-level documentation, and see <a class="el" href="matrixwrap.html">External matrix libraries</a> for an explanation of how the matrix code makes use of external libraries.</p>
<h1><a class="anchor" id="matrix_sec_types"></a>
Matrix and vector types</h1>
<p>The most important types defined by the matrix library are <a class="el" href="classkaldi_1_1Matrix.html" title="A class for storing matrices. ">Matrix</a> and <a class="el" href="classkaldi_1_1Vector.html" title="A class representing a vector. ">Vector</a>. We can illustrate their use with an example: </p><div class="fragment"><div class="line">Vector&lt;float&gt; v(10), w(9);</div><div class="line"><span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 9; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line">   v(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>) = <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>; </div><div class="line">   w(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>) = <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>+1;</div><div class="line">}</div><div class="line">Matrix&lt;float&gt; M(10,9);</div><div class="line">M.AddVecVec(1.0, v, w);</div></div><!-- fragment --><p> The code above first sets up v and w as vectors of size 10 and 9 respectively (the last element of v will be zero as the constructor sets the data to zero). The parenthesis operator indexes the vectors; a matrix would be indexed as M(i,j). M is initialized to a 10 x 9 matrix. The last line of the code adds the outer product <img class="formulaInl" alt="$ v w^T $" src="form_22.png"/> to M. The naming scheme for the function is based on writing the operation as an equation, in this case: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ M \leftarrow M + \alpha v w^T \]" src="form_23.png"/>
</p>
<p> The "+" becomes "Add" in the name, and the types of the non-scalar arguments become parts of the name too, in this case "Vec" for v and "Vec" for w (so AddVecVec). The type of M doesn't appear here as the function is its class member.</p>
<p>Also notice that we correctly sized M before adding the outer product (we could have done this without using the constructor by calling <a class="el" href="classkaldi_1_1Matrix.html#a70c095b28633f8874632a9d239a903d5">Resize</a>). The matrix library never tries to "guess" what size you want something to be, it will just crash if something is the wrong size. The only things that will resize a matrix are the constructor, <a class="el" href="classkaldi_1_1Matrix.html#a70c095b28633f8874632a9d239a903d5">Resize</a>, and <a class="el" href="classkaldi_1_1Matrix.html#aee763dab434f2d24c20edf16dada3abc">Read</a> (and the assignment operator, which is mainly included so that we can declare std::vector&lt;<a class="el" href="classkaldi_1_1Matrix.html">Matrix&lt;double&gt;</a> &gt; and the like).</p>
<p>To provide another example, if A, B and C are matrices and alpha and beta are scalars, to execute </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ A = \alpha B C^T + \beta A \]" src="form_24.png"/>
</p>
<p> we would use the line of code </p><div class="fragment"><div class="line">A.AddMatMat(alpha, B, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>, C, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>, beta);</div></div><!-- fragment --><p> Here, kNoTrans and kTrans are enumeration values that indicate whether or not the matrix argument is transposed. An examples that illustrates this and some other issues is: </p><div class="fragment"><div class="line">Matrix&lt;float&gt; M(5, 10), N(5, 10), P(5, 5);</div><div class="line"><span class="comment">// initialize M and N somehow...</span></div><div class="line"><span class="comment">// next line: P := 1.0 * M * N^T + 0.0 * P.</span></div><div class="line">P.AddMatMat(1.0, M, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>, N, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>, 0.0);</div><div class="line"><span class="comment">// tr(M N^T)</span></div><div class="line"><span class="keywordtype">float</span> f = <a class="code" href="namespacekaldi.html#a94b9f349754706b9d6f38bb5ccc11c77">TraceMatMat</a>(M, N, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>),</div><div class="line">      g = P.Trace();</div><div class="line"><a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(f == g);  <span class="comment">// we use this macro for asserts in Kaldi </span></div><div class="line"><span class="comment">// code (prints stack trace and throws exception).</span></div></div><!-- fragment --><p>Note that in the BLAS tradition, there is no operation that does just, say, <img class="formulaInl" alt="$ A = B C $" src="form_25.png"/>; you have to use a special case of the example we just gave (e.g. with alpha=1 and beta=0).</p>
<p>To get an idea of what mathematical member functions are available in the <a class="el" href="classkaldi_1_1Matrix.html" title="A class for storing matrices. ">Matrix</a> and <a class="el" href="classkaldi_1_1Vector.html" title="A class representing a vector. ">Vector</a> classes, see the documentation for <a class="el" href="classkaldi_1_1MatrixBase.html" title="Base class which provides matrix operations not involving resizing or allocation. ...">MatrixBase</a> and <a class="el" href="classkaldi_1_1VectorBase.html" title="Provides a vector abstraction class. ">VectorBase</a>.</p>
<h1><a class="anchor" id="matrix_sec_sym"></a>
Symmetric and triangular matrices</h1>
<p>There are special types for symmetric matrices (<a class="el" href="classkaldi_1_1SpMatrix.html">SpMatrix</a>) and triangular matrices (<a class="el" href="classkaldi_1_1TpMatrix.html">TpMatrix</a>). These are both represented in memory as a "packed" lower-triangular matrix and both inherit from <a class="el" href="classkaldi_1_1PackedMatrix.html">PackedMatrix</a>. Of these, <a class="el" href="classkaldi_1_1SpMatrix.html" title="Packed symetric matrix class. ">SpMatrix</a> is the most useful (<a class="el" href="classkaldi_1_1TpMatrix.html" title="Packed symetric matrix class. ">TpMatrix</a> is mostly just used to compute Cholesky factors). A typical example of using these types is below. Notice the "AddMat2" function. This illustrates a new feature of our naming scheme: when a quantity appears twice in an expression we add "2" to the corresponding part of the function name. </p><div class="fragment"><div class="line">Matrix&lt;float&gt; feats(1000, 39);</div><div class="line"><span class="comment">// ... initialize feats somehow ...</span></div><div class="line">SpMatrix&lt;float&gt; scatter(39);</div><div class="line"><span class="comment">// next line does scatter = 0.001 * feats&#39; * feats.</span></div><div class="line">scatter.AddMat2(1.0/1000, feats, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>, 0.0);</div><div class="line">TpMatrix&lt;float&gt; cholesky(39);</div><div class="line">cholesky.Cholesky(scatter);</div><div class="line">cholesky.Invert();</div><div class="line">Matrix&lt;float&gt; whitened_feats(1000, 39);</div><div class="line"><span class="comment">// If scatter = C C^T, next line does:</span></div><div class="line"><span class="comment">//  whitened_feats = feats * C^{-T}</span></div><div class="line">whitened_feats.AddMatTp(1.0, feats, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>, cholesky, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>, 0.0);</div></div><!-- fragment --><p> This code would crash (cholesky.Invert() would throw an exception) if we did not initialize the features somehow where indicated.</p>
<h1><a class="anchor" id="matrix_sec_sub"></a>
Sub-vectors and sub-matrices.</h1>
<p>For matrix operations that involve only part of a vector or matrix, the <a class="el" href="classkaldi_1_1SubVector.html">SubVector</a> and <a class="el" href="classkaldi_1_1SubMatrix.html">SubMatrix</a> classes are provided. Like <a class="el" href="classkaldi_1_1Vector.html">Vector</a> and <a class="el" href="classkaldi_1_1Matrix.html">Matrix</a>, these inherit from <a class="el" href="classkaldi_1_1VectorBase.html">VectorBase</a> and <a class="el" href="classkaldi_1_1MatrixBase.html">MatrixBase</a> respectively, so the implementation of operations that don't involve resizing is shared (you can never resize a <a class="el" href="classkaldi_1_1SubVector.html" title="Represents a non-allocating general vector which can be defined as a sub-vector of higher-level vecto...">SubVector</a> or <a class="el" href="classkaldi_1_1SubMatrix.html" title="Sub-matrix representation. ">SubMatrix</a> because it's treated as a pointer into the underlying <a class="el" href="classkaldi_1_1Vector.html" title="A class representing a vector. ">Vector</a> or <a class="el" href="classkaldi_1_1Matrix.html" title="A class for storing matrices. ">Matrix</a>).</p>
<p>An example of using these classes is here: </p><div class="fragment"><div class="line">Vector&lt;float&gt; v(10), w(10);</div><div class="line">Matrix&lt;float&gt; M(10, 10);</div><div class="line">SubVector&lt;float&gt; vs(v, 1, 9), ws(w, 1, 9);</div><div class="line">SubMatrix&lt;float&gt; Ms(M, 1, 9, 1, 9);</div><div class="line"><span class="comment">// next line would be v(2:10) += M(2:10,2:10)*w(2:10) in some</span></div><div class="line"><span class="comment">// math scripting languages.</span></div><div class="line">vs.AddMatVec(1.0, Ms, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>, ws);</div></div><!-- fragment --><p> There are other ways to obtain these types. If M is a matrix, M.Row(3) will return row 3 of M, as a <a class="el" href="classkaldi_1_1SubVector.html" title="Represents a non-allocating general vector which can be defined as a sub-vector of higher-level vecto...">SubVector</a>. There is a corresponding constructor, for example: </p><div class="fragment"><div class="line">SubVector row_of_m(M, 0); <span class="comment">// get zeroth row of M.</span></div></div><!-- fragment --><p> The same doesn't work for columns. This is because our vector types are contiguous in memory; we don't currently have a "stride" class-member (even though the underlying BLAS supports this). Another way to obtain these types is by using the Range functions of <a class="el" href="classkaldi_1_1Vector.html" title="A class representing a vector. ">Vector</a> and <a class="el" href="classkaldi_1_1Matrix.html" title="A class for storing matrices. ">Matrix</a>. For instance: </p><div class="fragment"><div class="line"><span class="comment">// get a sub-vector of length 5 starting from position 0; zero it.</span></div><div class="line">v.Range(0, 5).SetZero();</div><div class="line"><span class="comment">// get a sub-matrix of size 2x2 starting from position (5,5); zero it.</span></div><div class="line">M.Range(5, 2, 5, 2).SetZero(); </div></div><!-- fragment --><p> You have to be a little careful with <a class="el" href="classkaldi_1_1SubVector.html" title="Represents a non-allocating general vector which can be defined as a sub-vector of higher-level vecto...">SubVector</a> and <a class="el" href="classkaldi_1_1SubMatrix.html" title="Sub-matrix representation. ">SubMatrix</a> types. For instance, if you create a <a class="el" href="classkaldi_1_1SubVector.html" title="Represents a non-allocating general vector which can be defined as a sub-vector of higher-level vecto...">SubVector</a> and then destroy or resize the underlying <a class="el" href="classkaldi_1_1Vector.html" title="A class representing a vector. ">Vector</a> or <a class="el" href="classkaldi_1_1Matrix.html" title="A class for storing matrices. ">Matrix</a>, the <a class="el" href="classkaldi_1_1SubVector.html" title="Represents a non-allocating general vector which can be defined as a sub-vector of higher-level vecto...">SubVector</a> will be pointing to freed memory. Also, <a class="el" href="classkaldi_1_1SubVector.html" title="Represents a non-allocating general vector which can be defined as a sub-vector of higher-level vecto...">SubVector</a> and <a class="el" href="classkaldi_1_1SubMatrix.html" title="Sub-matrix representation. ">SubMatrix</a> do not respect const-ness the way they ideally should, so it is possible to modify a const <a class="el" href="classkaldi_1_1Vector.html" title="A class representing a vector. ">Vector</a> by creating a <a class="el" href="classkaldi_1_1SubVector.html" title="Represents a non-allocating general vector which can be defined as a sub-vector of higher-level vecto...">SubVector</a>. Fixing these issues would have made the library a lot more complex.</p>
<h1><a class="anchor" id="matrix_sec_calling"></a>
Calling conventions for vectors and matrices</h1>
<p>In general, when a function requires a vector or matrix type, for greater flexibility we pass an argument of type e.g. VectorBase&lt;BaseFloat&gt; or MatrixBase&lt;BaseFloat&gt; rather than Vector&lt;BaseFloat&gt; or <a class="el" href="classkaldi_1_1Matrix.html">Matrix&lt;BaseFloat&gt;</a>. That way the code is still callable if we are really passing a sub-matrix or sub-vector. The exception is where the code needs to resize the vector or matrix in question, in which case it would take a pointer of type e.g. Vector&lt;BaseFloat&gt;* or <a class="el" href="classkaldi_1_1Matrix.html">Matrix&lt;BaseFloat&gt;</a>*; it cannot take a reference because resizing is non-const, and as per the style guide, functions cannot take non-const reference arguments.</p>
<h1><a class="anchor" id="matrix_sec_copy"></a>
Copying matrix and vector types</h1>
<p>There are different ways to copy vectors and matrices. The simplest ones are the CopyFrom functions, for instance <a class="el" href="classkaldi_1_1MatrixBase.html#a557fe407783c0d8f2e604666fd48f96d" title="Copy given matrix. (no resize is done). ">Matrix::CopyFromMat</a>, <a class="el" href="classkaldi_1_1VectorBase.html#a959973067b5f0a4b205c9d8385fa33df" title="Copy data from another vector (must match own size). ">Vector::CopyFromVec</a>, <a class="el" href="classkaldi_1_1SpMatrix.html#a1477d48c6104d9223a230acdc706a349">SpMatrix::CopyFromSp</a> and so on. These will work even between float and double, unlike most of the mathematical operations. However, they will not resize the matrix for you and will crash if the sizes are wrong (you have to resize yourself using <a class="el" href="classkaldi_1_1Vector.html#ae98e624cca1982e866ff195131ed4427" title="Set vector to a specified size (can be zero). ">Vector::Resize</a>, <a class="el" href="classkaldi_1_1Matrix.html#a70c095b28633f8874632a9d239a903d5" title="Sets matrix to a specified size (zero is OK as long as both r and c are zero). ">Matrix::Resize</a> and so on). The same types of functions are available to copy between different matrix types, where this makes sense: for example, <a class="el" href="classkaldi_1_1MatrixBase.html#a0e5c5183170fdcf8933b9e87a270cbbd" title="Copy given tpmatrix. (no resize is done). ">Matrix::CopyFromTp</a>, <a class="el" href="classkaldi_1_1SpMatrix.html#a61478300b80eef8a52a6f7188b8eac6c">SpMatrix::CopyFromMat</a>, <a class="el" href="classkaldi_1_1TpMatrix.html#a0ed1221c38842a43d3f50e42d4d691a2" title="CopyFromMat copies the lower triangle of M into *this (or the upper triangle, if Trans == kTrans)...">TpMatrix::CopyFromMat</a> and so on. See the documentation of those functions for their exact behavior.</p>
<p>Wherever the above functions exist, corresponding constructors exist. These will do the copying but also resize, for instance: </p><div class="fragment"><div class="line">Matrix&lt;double&gt; M(10, 10);</div><div class="line">... initialize M ...</div><div class="line"><span class="comment">// next line copies M to Mf.</span></div><div class="line">Matrix&lt;<span class="keywordtype">float</span>&gt; Mf(M);</div></div><!-- fragment --><p> There are also more special-purpose copying functions. You can copy the concatenated rows of a matrix to a vector (<a class="el" href="classkaldi_1_1VectorBase.html#ae07f9efcd41c79573aef065065b12f28" title="Performs a row stack of the matrix M. ">Vector::CopyRowsFromMat</a>), the same for the columns (<a class="el" href="classkaldi_1_1VectorBase.html#aef004252892d6c81e9343453474a0d2a" title="Performs a column stack of the matrix M. ">Vector::CopyColsFromMat</a>), and do the reverse too (<a class="el" href="classkaldi_1_1MatrixBase.html#a0db477a6b3daf0a83142ae056256e1e3" title="This function has two modes of operation. ">Matrix::CopyRowsFromVec</a> and <a class="el" href="classkaldi_1_1MatrixBase.html#aa2ffb845eb1004d74208c9c5eaa11435" title="Copies vector into matrix, column-by-column. ">Matrix::CopyColsFromVec</a>). The same functions exist for copying an individual row or column from a matrix to a vector and vice versa: see <a class="el" href="classkaldi_1_1VectorBase.html#af64f4a3d1595f0bd1b11ab0fc40f9578" title="Extracts a row of the matrix M. ">Vector::CopyRowFromMat</a>, <a class="el" href="classkaldi_1_1VectorBase.html#a7c1e46a5355ae05c048e7c236406fe50" title="Extracts a column of the matrix M. ">Vector::CopyColFromMat</a>, <a class="el" href="classkaldi_1_1MatrixBase.html#a0fb8276b2c7f0ccfd996c37df4298568" title="Copy vector into specific row of matrix. ">Matrix::CopyRowFromVec</a> and <a class="el" href="classkaldi_1_1MatrixBase.html#a109e99b3999f5a7d94e2df2c8ed180de" title="Copy vector into specific column of matrix. ">Matrix::CopyColFromVec</a>. The row versions of these operations are only provided for symmetry, because you could do the same using <a class="el" href="classkaldi_1_1SubVector.html" title="Represents a non-allocating general vector which can be defined as a sub-vector of higher-level vecto...">SubVector</a> in the row case (see <a class="el" href="matrix.html#matrix_sec_sub">Sub-vectors and sub-matrices.</a>).</p>
<h1><a class="anchor" id="matrix_sec_scalar"></a>
Scalar products</h1>
<p>Various functions that return scalars (and do not modify their parameters) are defined not as class members but as functions. See <a class="el" href="group__matrix__funcs__scalar.html">Matrix-vector functions returning scalars</a> for a list of these. Typical examples are: </p><div class="fragment"><div class="line"><span class="keywordtype">float</span> f = <a class="code" href="group__matrix__funcs__scalar.html#ga4750cd6f7a02a013435779588056b153">VecVec</a>(v, w), <span class="comment">// v&#39; * w</span></div><div class="line">      g = <a class="code" href="group__matrix__funcs__scalar.html#gadc8bcf380e9e0d5f0ef01150550a0706">VecMatVec</a>(v, M, w),  <span class="comment">// v&#39; * M * w</span></div><div class="line">      h = <a class="code" href="namespacekaldi.html#a94b9f349754706b9d6f38bb5ccc11c77">TraceMatMat</a>(M, N, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>); <span class="comment">// tr(M * N)</span></div></div><!-- fragment --><h1><a class="anchor" id="matric_sec_resizing"></a>
Resizing</h1>
<p>All matrix and vector types (except for <a class="el" href="classkaldi_1_1SubMatrix.html" title="Sub-matrix representation. ">SubMatrix</a> and <a class="el" href="classkaldi_1_1SubVector.html" title="Represents a non-allocating general vector which can be defined as a sub-vector of higher-level vecto...">SubVector</a>) may be resized. Examples of this are below: </p><div class="fragment"><div class="line">Vector&lt;float&gt; v;</div><div class="line">Matrix&lt;float&gt; M;</div><div class="line">SpMatrix&lt;float&gt; S;</div><div class="line">v.Resize(10);</div><div class="line">M.Resize(5, 10);</div><div class="line">S.Resize(10);</div></div><!-- fragment --><p> The Resize functions will set the new data to zero unless you provide an optional argument of type <a class="el" href="namespacekaldi.html#ab4ace1fea44c7724ab9a76d70abad80b">MatrixResizeType</a>. The possible values are:</p><ul>
<li><a class="el" href="namespacekaldi.html#ab4ace1fea44c7724ab9a76d70abad80bae9d0df3a51f0394dd8e041960265c112">kSetZero</a> (the default): sets the data to zero</li>
<li><a class="el" href="namespacekaldi.html#ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126">kUndefined</a> : leaves the data undefined</li>
<li><a class="el" href="namespacekaldi.html#ab4ace1fea44c7724ab9a76d70abad80ba6ccfb1220c1b49764f14603227edd6e0">kCopyData</a> : Copies any old data that shared the same index as the new data, leaving new indices at zero.</li>
</ul>
<p>Thus, the code </p><div class="fragment"><div class="line">v.Resize(v.Dim() + 1, <a class="code" href="namespacekaldi.html#ab4ace1fea44c7724ab9a76d70abad80ba6ccfb1220c1b49764f14603227edd6e0">kCopyData</a>);</div></div><!-- fragment --><p> will append a zero to v. This is not a particularly efficient way to append something to a list, though (it will newly allocate the whole array).</p>
<p>Constructors that take dimension arguments also optionally take a ResizeType argument (the default is kSetZero), so constructors behave in the same way as the Resize functions.</p>
<h1><a class="anchor" id="matrix_sec_io"></a>
Matrix I/O</h1>
<p>Matrix I/O is done in the same style as other Kaldi code (see <a class="el" href="io.html">Kaldi I/O mechanisms</a>). A typical example of reading and writing these types is: </p><div class="fragment"><div class="line"><span class="keywordtype">bool</span> binary = <span class="keyword">false</span>;</div><div class="line">std::ofstream os( ... );</div><div class="line">Vector&lt;float&gt; v;</div><div class="line">v.Write(os, binary);</div><div class="line">...</div><div class="line">std::ifstream is( ... );</div><div class="line">Vector&lt;float&gt; v;</div><div class="line">v.Read(is, binary);</div></div><!-- fragment --><p> There also stream operators &lt;&lt; and &gt;&gt; that do the same thing (in text mode only, not binary), but these are mainly intended for debugging. The text format of these objects looks like (for a vector): </p><div class="fragment"><div class="line">[ 2.77914 1.50866 1.01017 0.263783 ] </div></div><!-- fragment --><p> and for a matrix: </p><div class="fragment"><div class="line">[ -0.825915 -0.899772 0.158694 -0.731197 </div><div class="line"> 0.141949 0.827187 0.62493 -0.67114 </div><div class="line">-0.814922 -0.367702 -0.155766 -0.135577 </div><div class="line"> 0.286447 0.648148 -0.643773 0.724163 </div><div class="line">] </div></div><!-- fragment --><h1><a class="anchor" id="matrix_sec_other"></a>
Other matrix library functions</h1>
<p>This page is only a brief introduction to the matrix library. Most mathematical operations are members of the classes <a class="el" href="classkaldi_1_1MatrixBase.html" title="Base class which provides matrix operations not involving resizing or allocation. ...">MatrixBase</a>, <a class="el" href="classkaldi_1_1VectorBase.html" title="Provides a vector abstraction class. ">VectorBase</a>, <a class="el" href="classkaldi_1_1SpMatrix.html" title="Packed symetric matrix class. ">SpMatrix</a> and <a class="el" href="classkaldi_1_1TpMatrix.html" title="Packed symetric matrix class. ">TpMatrix</a>, and can be discovered there. Functions returning scalars are listed <a class="el" href="group__matrix__funcs__scalar.html">here</a>. Some miscellaneous functions, including fourier transforms and the matrix exponential, are implemented as separate functions and classes and may be found <a class="el" href="group__matrix__funcs__misc.html">here</a>. We note that not all parts of the library have been optimized as fully as they could be. Our approach has been to quickly implement functionality that we need, and only optimize those parts that are taking a substantial amount of time in some scenario. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="index.html">Kaldi</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
