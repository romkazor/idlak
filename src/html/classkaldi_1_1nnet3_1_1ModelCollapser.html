<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Kaldi: ModelCollapser Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" href="favicon.ico" type="image/x-icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" /> 
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
 <td id="projectlogo"><a href="http://kaldi-asr.org/"><img alt="Logo" src="KaldiTextAndLogoSmall.png"/ style="padding: 3px 5px 1px 5px"></a></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname" style="display:none">Kaldi
   </div>
  </td>
    <td style="padding-left: 0.5em;">
    <div id="projectbrief" style="display:none"></div>
    </td>
   <!--END PROJECT_BRIEF-->
  <!--END !PROJECT_NAME-->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classkaldi_1_1nnet3_1_1ModelCollapser.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-static-methods">Static Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classkaldi_1_1nnet3_1_1ModelCollapser-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">ModelCollapser Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for ModelCollapser:</div>
<div class="dyncontent">
<div class="center"><img src="classkaldi_1_1nnet3_1_1ModelCollapser__coll__graph.png" border="0" usemap="#ModelCollapser_coll__map" alt="Collaboration graph"/></div>
<map name="ModelCollapser_coll__map" id="ModelCollapser_coll__map">
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a3b797f5ee586778fc84e145ae21a51e2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#a3b797f5ee586778fc84e145ae21a51e2">ModelCollapser</a> (const <a class="el" href="structkaldi_1_1nnet3_1_1CollapseModelConfig.html">CollapseModelConfig</a> &amp;config, <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> *nnet)</td></tr>
<tr class="separator:a3b797f5ee586778fc84e145ae21a51e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f4d9052b2e996267a8fbe2bab2066ed"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#a2f4d9052b2e996267a8fbe2bab2066ed">Collapse</a> ()</td></tr>
<tr class="separator:a2f4d9052b2e996267a8fbe2bab2066ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:ab0b55992607ac79a639c266301ee8a5b"><td class="memItemLeft" align="right" valign="top">int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ab0b55992607ac79a639c266301ee8a5b">CollapseComponents</a> (int32 component_index1, int32 component_index2)</td></tr>
<tr class="memdesc:ab0b55992607ac79a639c266301ee8a5b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function tries to collapse two successive components, where the component 'component_index1' appears as the input of 'component_index2'.  <a href="#ab0b55992607ac79a639c266301ee8a5b">More...</a><br /></td></tr>
<tr class="separator:ab0b55992607ac79a639c266301ee8a5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74229f66155b91205418f6cbffab377b"><td class="memItemLeft" align="right" valign="top">int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#a74229f66155b91205418f6cbffab377b">SumDescriptorIsCollapsible</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1SumDescriptor.html">SumDescriptor</a> &amp;sum_desc)</td></tr>
<tr class="separator:a74229f66155b91205418f6cbffab377b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14b74ea006010f7b526a63ef19ab8750"><td class="memItemLeft" align="right" valign="top">int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#a14b74ea006010f7b526a63ef19ab8750">DescriptorIsCollapsible</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Descriptor.html">Descriptor</a> &amp;desc)</td></tr>
<tr class="separator:a14b74ea006010f7b526a63ef19ab8750"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69e50be80095eb47492cc6ba87102707"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classkaldi_1_1nnet3_1_1Descriptor.html">Descriptor</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#a69e50be80095eb47492cc6ba87102707">ReplaceNodeInDescriptor</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Descriptor.html">Descriptor</a> &amp;src, int32 node_to_replace, const <a class="el" href="classkaldi_1_1nnet3_1_1Descriptor.html">Descriptor</a> &amp;expr)</td></tr>
<tr class="separator:a69e50be80095eb47492cc6ba87102707"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bf6036cd76aa5d866fc73433c6efd6f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#a8bf6036cd76aa5d866fc73433c6efd6f">OptimizeNode</a> (int32 node_index)</td></tr>
<tr class="memdesc:a8bf6036cd76aa5d866fc73433c6efd6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function modifies the neural network in the case where 'node_index' is a component-input node whose component (in the node at 'node_index + 1), if a bunch of other conditions also apply.  <a href="#a8bf6036cd76aa5d866fc73433c6efd6f">More...</a><br /></td></tr>
<tr class="separator:a8bf6036cd76aa5d866fc73433c6efd6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ca02a1c32e54f7644650710b881c551"><td class="memItemLeft" align="right" valign="top">int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#a3ca02a1c32e54f7644650710b881c551">CollapseComponentsDropout</a> (int32 component_index1, int32 component_index2)</td></tr>
<tr class="memdesc:a3ca02a1c32e54f7644650710b881c551"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tries to produce a component that's equivalent to running the component 'component_index2' with input given by 'component_index1'.  <a href="#a3ca02a1c32e54f7644650710b881c551">More...</a><br /></td></tr>
<tr class="separator:a3ca02a1c32e54f7644650710b881c551"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47af881dbac6fd811414d7e6487c7bbb"><td class="memItemLeft" align="right" valign="top">int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#a47af881dbac6fd811414d7e6487c7bbb">CollapseComponentsBatchnorm</a> (int32 component_index1, int32 component_index2)</td></tr>
<tr class="memdesc:a47af881dbac6fd811414d7e6487c7bbb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tries to produce a component that's equivalent to running the component 'component_index2' with input given by 'component_index1'.  <a href="#a47af881dbac6fd811414d7e6487c7bbb">More...</a><br /></td></tr>
<tr class="separator:a47af881dbac6fd811414d7e6487c7bbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46f09d70fc557227d41e02dbde35bce5"><td class="memItemLeft" align="right" valign="top">int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#a46f09d70fc557227d41e02dbde35bce5">CollapseComponentsAffine</a> (int32 component_index1, int32 component_index2)</td></tr>
<tr class="memdesc:a46f09d70fc557227d41e02dbde35bce5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tries to produce a component that's equivalent to running the component 'component_index2' with input given by 'component_index1'.  <a href="#a46f09d70fc557227d41e02dbde35bce5">More...</a><br /></td></tr>
<tr class="separator:a46f09d70fc557227d41e02dbde35bce5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03db4a58d5e01d5a7f0f964d9575e7f5"><td class="memItemLeft" align="right" valign="top">int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#a03db4a58d5e01d5a7f0f964d9575e7f5">CollapseComponentsScale</a> (int32 component_index1, int32 component_index2)</td></tr>
<tr class="memdesc:a03db4a58d5e01d5a7f0f964d9575e7f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tries to produce a component that's equivalent to running the component 'component_index2' with input given by 'component_index1'.  <a href="#a03db4a58d5e01d5a7f0f964d9575e7f5">More...</a><br /></td></tr>
<tr class="separator:a03db4a58d5e01d5a7f0f964d9575e7f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74183a1452e88c063a63b1ec9119687d"><td class="memItemLeft" align="right" valign="top">int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#a74183a1452e88c063a63b1ec9119687d">GetDiagonallyPreModifiedComponentIndex</a> (const <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;offset, const <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;scale, const std::string &amp;src_identifier, int32 component_index)</td></tr>
<tr class="memdesc:a74183a1452e88c063a63b1ec9119687d"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function finds, or creates, a component which is like 'component_index' but is combined with a diagonal offset-and-scale transform *before* the component.  <a href="#a74183a1452e88c063a63b1ec9119687d">More...</a><br /></td></tr>
<tr class="separator:a74183a1452e88c063a63b1ec9119687d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab76ab5aac5135489b01f373372ee0e3a"><td class="memItemLeft" align="right" valign="top">int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ab76ab5aac5135489b01f373372ee0e3a">GetScaledComponentIndex</a> (int32 component_index, <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> scale)</td></tr>
<tr class="memdesc:ab76ab5aac5135489b01f373372ee0e3a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given a component 'component_index', returns a component which will give the same output as the current component gives when its input is scaled by 'scale'.  <a href="#ab76ab5aac5135489b01f373372ee0e3a">More...</a><br /></td></tr>
<tr class="separator:ab76ab5aac5135489b01f373372ee0e3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-methods"></a>
Static Private Member Functions</h2></td></tr>
<tr class="memitem:af8944368b3f6af35487ea58c57c62bd1"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#af8944368b3f6af35487ea58c57c62bd1">PreMultiplyAffineParameters</a> (const <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;offset, const <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;scale, <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; *bias_params, <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; *linear_params)</td></tr>
<tr class="memdesc:af8944368b3f6af35487ea58c57c62bd1"><td class="mdescLeft">&#160;</td><td class="mdescRight">This helper function, used GetDiagonallyPreModifiedComponentIndex, modifies the linear and bias parameters of an affine transform to capture the effect of preceding that affine transform by a diagonal affine transform with parameters 'offset' and 'scale'.  <a href="#af8944368b3f6af35487ea58c57c62bd1">More...</a><br /></td></tr>
<tr class="separator:af8944368b3f6af35487ea58c57c62bd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a1dce8d84995d048f91d9ec9b1d8e874c"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structkaldi_1_1nnet3_1_1CollapseModelConfig.html">CollapseModelConfig</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#a1dce8d84995d048f91d9ec9b1d8e874c">config_</a></td></tr>
<tr class="separator:a1dce8d84995d048f91d9ec9b1d8e874c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6b2732bea7ce47719f18ad2b06d81d2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a></td></tr>
<tr class="separator:ae6b2732bea7ce47719f18ad2b06d81d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="nnet-utils_8cc_source.html#l01353">1353</a> of file <a class="el" href="nnet-utils_8cc_source.html">nnet-utils.cc</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a3b797f5ee586778fc84e145ae21a51e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b797f5ee586778fc84e145ae21a51e2">&#9670;&nbsp;</a></span>ModelCollapser()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1nnet3_1_1ModelCollapser.html">ModelCollapser</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1nnet3_1_1CollapseModelConfig.html">CollapseModelConfig</a> &amp;&#160;</td>
          <td class="paramname"><em>config</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> *&#160;</td>
          <td class="paramname"><em>nnet</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-utils_8cc_source.html#l01355">1355</a> of file <a class="el" href="nnet-utils_8cc_source.html">nnet-utils.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;                            :</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;      <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#a1dce8d84995d048f91d9ec9b1d8e874c">config_</a>(config), <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>(nnet) { }</div><div class="ttc" id="classkaldi_1_1nnet3_1_1ModelCollapser_html_a1dce8d84995d048f91d9ec9b1d8e874c"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ModelCollapser.html#a1dce8d84995d048f91d9ec9b1d8e874c">kaldi::nnet3::ModelCollapser::config_</a></div><div class="ttdeci">const CollapseModelConfig &amp; config_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l02002">nnet-utils.cc:2002</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ModelCollapser_html_ae6b2732bea7ce47719f18ad2b06d81d2"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">kaldi::nnet3::ModelCollapser::nnet_</a></div><div class="ttdeci">Nnet * nnet_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l02003">nnet-utils.cc:2003</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a2f4d9052b2e996267a8fbe2bab2066ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f4d9052b2e996267a8fbe2bab2066ed">&#9670;&nbsp;</a></span>Collapse()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Collapse </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-utils_8cc_source.html#l01358">1358</a> of file <a class="el" href="nnet-utils_8cc_source.html">nnet-utils.cc</a>.</p>

<p class="reference">References <a class="el" href="kaldi-error_8h_source.html#l00126">KALDI_ERR</a>, <a class="el" href="kaldi-error_8h_source.html#l00132">KALDI_LOG</a>, <a class="el" href="namespacernnlm.html#ab4871778d570f724a07823e0a2fb9884">rnnlm::n</a>, <a class="el" href="nnet-utils_8cc_source.html#l00882">SvdApplier::nnet_</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00124">Nnet::NumComponents()</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00126">Nnet::NumNodes()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00844">Nnet::RemoveOrphanComponents()</a>, and <a class="el" href="_2nnet-nnet_8cc_source.html#l00932">Nnet::RemoveOrphanNodes()</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-utils_8cc_source.html#l02007">kaldi::nnet3::CollapseModel()</a>.</p>
<div class="fragment"><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;                  {</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;    <span class="keywordtype">bool</span> changed = <span class="keyword">true</span>;</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    int32 num_nodes = <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a3213a214cf17e6fa16bc696b457545f3">NumNodes</a>(),</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;        num_iters = 0;</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    int32 num_components1 = <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a15b5336b4413124b1fd4531f57781182">NumComponents</a>();</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    <span class="keywordflow">for</span> (; changed; num_iters++) {</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;      changed = <span class="keyword">false</span>;</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;      <span class="keywordflow">for</span> (int32 <a class="code" href="namespacernnlm.html#ab4871778d570f724a07823e0a2fb9884">n</a> = 0; <a class="code" href="namespacernnlm.html#ab4871778d570f724a07823e0a2fb9884">n</a> &lt; num_nodes; <a class="code" href="namespacernnlm.html#ab4871778d570f724a07823e0a2fb9884">n</a>++)</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#a8bf6036cd76aa5d866fc73433c6efd6f">OptimizeNode</a>(<a class="code" href="namespacernnlm.html#ab4871778d570f724a07823e0a2fb9884">n</a>))</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;          changed = <span class="keyword">true</span>;</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;      <span class="comment">// we shouldn&#39;t iterate more than a couple of times.</span></div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;      <span class="keywordflow">if</span> (num_iters &gt;= 10)</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;        <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Something went wrong collapsing model.&quot;</span>;</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    }</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    int32 num_components2 = <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a15b5336b4413124b1fd4531f57781182">NumComponents</a>();</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a3c6807944ed8b7a87935d6fd204be37c">RemoveOrphanNodes</a>();</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a09a6b734631cb430d5ef42db1d3f8e70">RemoveOrphanComponents</a>();</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;    int32 num_components3 = <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a15b5336b4413124b1fd4531f57781182">NumComponents</a>();</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;    <span class="keywordflow">if</span> (num_components2 != num_components1 ||</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;        num_components3 != num_components2)</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;      <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Added &quot;</span> &lt;&lt; (num_components2 - num_components1)</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; components, removed &quot;</span></div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;                &lt;&lt; (num_components2 - num_components3);</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;  }</div><div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_a3213a214cf17e6fa16bc696b457545f3"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#a3213a214cf17e6fa16bc696b457545f3">kaldi::nnet3::Nnet::NumNodes</a></div><div class="ttdeci">int32 NumNodes() const</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00126">nnet-nnet.h:126</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ModelCollapser_html_a8bf6036cd76aa5d866fc73433c6efd6f"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ModelCollapser.html#a8bf6036cd76aa5d866fc73433c6efd6f">kaldi::nnet3::ModelCollapser::OptimizeNode</a></div><div class="ttdeci">bool OptimizeNode(int32 node_index)</div><div class="ttdoc">This function modifies the neural network in the case where &amp;#39;node_index&amp;#39; is a component-input node wh...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l01544">nnet-utils.cc:1544</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_a09a6b734631cb430d5ef42db1d3f8e70"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#a09a6b734631cb430d5ef42db1d3f8e70">kaldi::nnet3::Nnet::RemoveOrphanComponents</a></div><div class="ttdeci">void RemoveOrphanComponents()</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00844">nnet-nnet.cc:844</a></div></div>
<div class="ttc" id="namespacernnlm_html_ab4871778d570f724a07823e0a2fb9884"><div class="ttname"><a href="namespacernnlm.html#ab4871778d570f724a07823e0a2fb9884">rnnlm::n</a></div><div class="ttdeci">struct rnnlm::@11::@12 n</div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_a3c6807944ed8b7a87935d6fd204be37c"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#a3c6807944ed8b7a87935d6fd204be37c">kaldi::nnet3::Nnet::RemoveOrphanNodes</a></div><div class="ttdeci">void RemoveOrphanNodes(bool remove_orphan_inputs=false)</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00932">nnet-nnet.cc:932</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ModelCollapser_html_ae6b2732bea7ce47719f18ad2b06d81d2"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">kaldi::nnet3::ModelCollapser::nnet_</a></div><div class="ttdeci">Nnet * nnet_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l02003">nnet-utils.cc:2003</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00126">kaldi-error.h:126</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_a15b5336b4413124b1fd4531f57781182"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#a15b5336b4413124b1fd4531f57781182">kaldi::nnet3::Nnet::NumComponents</a></div><div class="ttdeci">int32 NumComponents() const</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00124">nnet-nnet.h:124</a></div></div>
<div class="ttc" id="group__error__group_html_gaf8fb55454306b60c9c1e07a6ef9d341a"><div class="ttname"><a href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a></div><div class="ttdeci">#define KALDI_LOG</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00132">kaldi-error.h:132</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab0b55992607ac79a639c266301ee8a5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0b55992607ac79a639c266301ee8a5b">&#9670;&nbsp;</a></span>CollapseComponents()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int32 CollapseComponents </td>
          <td>(</td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>component_index1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>component_index2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function tries to collapse two successive components, where the component 'component_index1' appears as the input of 'component_index2'. </p>
<p>If the two components can be collapsed in that way, it returns the index of a combined component.</p>
<p>Note: in addition to the two components simply being chained together, this function supports the case where different time-offsets of the first component are appendend together as the input of the second component. So the input-dim of the second component may be a multiple of the output-dim of the first component.</p>
<p>The function returns the component-index of a (newly created or existing) component that combines both of these components, if it's possible to combine them; or it returns -1 if it's not possible. </p>

<p class="definition">Definition at line <a class="el" href="nnet-utils_8cc_source.html#l01399">1399</a> of file <a class="el" href="nnet-utils_8cc_source.html">nnet-utils.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;                                                   {</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    int32 ans;</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#a1dce8d84995d048f91d9ec9b1d8e874c">config_</a>.<a class="code" href="structkaldi_1_1nnet3_1_1CollapseModelConfig.html#a68b8dd1c6811c8a4c8054c4dcc30384a">collapse_dropout</a> &amp;&amp;</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;        (ans = <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#a3ca02a1c32e54f7644650710b881c551">CollapseComponentsDropout</a>(component_index1,</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;                                         component_index2)) != -1)</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;      <span class="keywordflow">return</span> ans;</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#a1dce8d84995d048f91d9ec9b1d8e874c">config_</a>.<a class="code" href="structkaldi_1_1nnet3_1_1CollapseModelConfig.html#a38f8b82b32db47e1187625e83737b5a9">collapse_batchnorm</a> &amp;&amp;</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;        (ans = <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#a47af881dbac6fd811414d7e6487c7bbb">CollapseComponentsBatchnorm</a>(component_index1,</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;                                           component_index2)) != -1)</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;      <span class="keywordflow">return</span> ans;</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#a1dce8d84995d048f91d9ec9b1d8e874c">config_</a>.<a class="code" href="structkaldi_1_1nnet3_1_1CollapseModelConfig.html#a9d345990cb1292c6687f9c68c889fb09">collapse_affine</a> &amp;&amp;</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;        (ans = <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#a46f09d70fc557227d41e02dbde35bce5">CollapseComponentsAffine</a>(component_index1,</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;                                        component_index2)) != -1)</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;      <span class="keywordflow">return</span> ans;</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#a1dce8d84995d048f91d9ec9b1d8e874c">config_</a>.<a class="code" href="structkaldi_1_1nnet3_1_1CollapseModelConfig.html#a12ac400b4c35eb6852b1644b95b94a47">collapse_scale</a> &amp;&amp;</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;        (ans = <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#a03db4a58d5e01d5a7f0f964d9575e7f5">CollapseComponentsScale</a>(component_index1,</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;                                       component_index2)) != -1)</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;      <span class="keywordflow">return</span> ans;</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;  }</div><div class="ttc" id="classkaldi_1_1nnet3_1_1ModelCollapser_html_a3ca02a1c32e54f7644650710b881c551"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ModelCollapser.html#a3ca02a1c32e54f7644650710b881c551">kaldi::nnet3::ModelCollapser::CollapseComponentsDropout</a></div><div class="ttdeci">int32 CollapseComponentsDropout(int32 component_index1, int32 component_index2)</div><div class="ttdoc">Tries to produce a component that&amp;#39;s equivalent to running the component &amp;#39;component_index2&amp;#39; with input...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l01599">nnet-utils.cc:1599</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1CollapseModelConfig_html_a68b8dd1c6811c8a4c8054c4dcc30384a"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1CollapseModelConfig.html#a68b8dd1c6811c8a4c8054c4dcc30384a">kaldi::nnet3::CollapseModelConfig::collapse_dropout</a></div><div class="ttdeci">bool collapse_dropout</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-utils_8h_source.html#l00233">nnet-utils.h:233</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1CollapseModelConfig_html_a38f8b82b32db47e1187625e83737b5a9"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1CollapseModelConfig.html#a38f8b82b32db47e1187625e83737b5a9">kaldi::nnet3::CollapseModelConfig::collapse_batchnorm</a></div><div class="ttdeci">bool collapse_batchnorm</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-utils_8h_source.html#l00234">nnet-utils.h:234</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ModelCollapser_html_a1dce8d84995d048f91d9ec9b1d8e874c"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ModelCollapser.html#a1dce8d84995d048f91d9ec9b1d8e874c">kaldi::nnet3::ModelCollapser::config_</a></div><div class="ttdeci">const CollapseModelConfig &amp; config_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l02002">nnet-utils.cc:2002</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ModelCollapser_html_a47af881dbac6fd811414d7e6487c7bbb"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ModelCollapser.html#a47af881dbac6fd811414d7e6487c7bbb">kaldi::nnet3::ModelCollapser::CollapseComponentsBatchnorm</a></div><div class="ttdeci">int32 CollapseComponentsBatchnorm(int32 component_index1, int32 component_index2)</div><div class="ttdoc">Tries to produce a component that&amp;#39;s equivalent to running the component &amp;#39;component_index2&amp;#39; with input...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l01639">nnet-utils.cc:1639</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ModelCollapser_html_a03db4a58d5e01d5a7f0f964d9575e7f5"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ModelCollapser.html#a03db4a58d5e01d5a7f0f964d9575e7f5">kaldi::nnet3::ModelCollapser::CollapseComponentsScale</a></div><div class="ttdeci">int32 CollapseComponentsScale(int32 component_index1, int32 component_index2)</div><div class="ttdoc">Tries to produce a component that&amp;#39;s equivalent to running the component &amp;#39;component_index2&amp;#39; with input...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l01767">nnet-utils.cc:1767</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1CollapseModelConfig_html_a12ac400b4c35eb6852b1644b95b94a47"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1CollapseModelConfig.html#a12ac400b4c35eb6852b1644b95b94a47">kaldi::nnet3::CollapseModelConfig::collapse_scale</a></div><div class="ttdeci">bool collapse_scale</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-utils_8h_source.html#l00236">nnet-utils.h:236</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1CollapseModelConfig_html_a9d345990cb1292c6687f9c68c889fb09"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1CollapseModelConfig.html#a9d345990cb1292c6687f9c68c889fb09">kaldi::nnet3::CollapseModelConfig::collapse_affine</a></div><div class="ttdeci">bool collapse_affine</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-utils_8h_source.html#l00235">nnet-utils.h:235</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ModelCollapser_html_a46f09d70fc557227d41e02dbde35bce5"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ModelCollapser.html#a46f09d70fc557227d41e02dbde35bce5">kaldi::nnet3::ModelCollapser::CollapseComponentsAffine</a></div><div class="ttdeci">int32 CollapseComponentsAffine(int32 component_index1, int32 component_index2)</div><div class="ttdoc">Tries to produce a component that&amp;#39;s equivalent to running the component &amp;#39;component_index2&amp;#39; with input...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l01668">nnet-utils.cc:1668</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a46f09d70fc557227d41e02dbde35bce5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46f09d70fc557227d41e02dbde35bce5">&#9670;&nbsp;</a></span>CollapseComponentsAffine()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int32 CollapseComponentsAffine </td>
          <td>(</td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>component_index1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>component_index2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Tries to produce a component that's equivalent to running the component 'component_index2' with input given by 'component_index1'. </p>
<p>This handles the case where 'component_index1' is of type <a class="el" href="classkaldi_1_1nnet3_1_1FixedAffineComponent.html" title="FixedAffineComponent is an affine transform that is supplied at network initialization time and is no...">FixedAffineComponent</a>, <a class="el" href="classkaldi_1_1nnet3_1_1AffineComponent.html">AffineComponent</a> or <a class="el" href="classkaldi_1_1nnet3_1_1NaturalGradientAffineComponent.html">NaturalGradientAffineComponent</a>, and 'component_index2' is of type <a class="el" href="classkaldi_1_1nnet3_1_1AffineComponent.html">AffineComponent</a> or <a class="el" href="classkaldi_1_1nnet3_1_1NaturalGradientAffineComponent.html">NaturalGradientAffineComponent</a>.</p>
<p>Returns -1 if this code can't produce a combined component. </p>

<p class="definition">Definition at line <a class="el" href="nnet-utils_8cc_source.html#l01668">1668</a> of file <a class="el" href="nnet-utils_8cc_source.html">nnet-utils.cc</a>.</p>

<p class="reference">References <a class="el" href="_2nnet-nnet_8cc_source.html#l00161">Nnet::AddComponent()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01278">CuMatrixBase&lt; Real &gt;::AddMatMat()</a>, <a class="el" href="cu-vector_8cc_source.html#l00478">CuVectorBase&lt; Real &gt;::AddMatVec()</a>, <a class="el" href="nnet-simple-component_8h_source.html#l00455">AffineComponent::BiasParams()</a>, <a class="el" href="nnet-simple-component_8h_source.html#l01032">FixedAffineComponent::BiasParams()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00150">Nnet::GetComponent()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00474">Nnet::GetComponentIndex()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00689">Nnet::GetComponentName()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l01177">AffineComponent::Init()</a>, <a class="el" href="nnet-simple-component_8h_source.html#l00408">AffineComponent::InputDim()</a>, <a class="el" href="nnet-simple-component_8h_source.html#l01011">FixedAffineComponent::InputDim()</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, <a class="el" href="matrix-common_8h_source.html#l00034">kaldi::kNoTrans</a>, <a class="el" href="nnet-simple-component_8h_source.html#l00457">AffineComponent::LinearParams()</a>, <a class="el" href="nnet-simple-component_8h_source.html#l01031">FixedAffineComponent::LinearParams()</a>, <a class="el" href="nnet-utils_8cc_source.html#l00882">SvdApplier::nnet_</a>, <a class="el" href="cu-matrix_8h_source.html#l00215">CuMatrixBase&lt; Real &gt;::NumCols()</a>, <a class="el" href="cu-matrix_8h_source.html#l00214">CuMatrixBase&lt; Real &gt;::NumRows()</a>, <a class="el" href="nnet-simple-component_8h_source.html#l00409">AffineComponent::OutputDim()</a>, <a class="el" href="nnet-simple-component_8h_source.html#l01012">FixedAffineComponent::OutputDim()</a>, <a class="el" href="cu-vector_8h_source.html#l00145">CuVectorBase&lt; Real &gt;::Range()</a>, <a class="el" href="cu-matrix_8h_source.html#l00596">CuMatrixBase&lt; Real &gt;::Range()</a>, and <a class="el" href="nnet-simple-component_8cc_source.html#l01134">AffineComponent::SetParams()</a>.</p>
<div class="fragment"><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;                                                         {</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    <span class="keyword">const</span> FixedAffineComponent *fixed_affine_component1 =</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;        <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>FixedAffineComponent*<span class="keyword">&gt;</span>(</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;            <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#aec8d6dfed3e4ab080d3ff4cf6a1126e3">GetComponent</a>(component_index1));</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    <span class="keyword">const</span> AffineComponent *affine_component1 =</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;        <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>AffineComponent*<span class="keyword">&gt;</span>(</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;            <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#aec8d6dfed3e4ab080d3ff4cf6a1126e3">GetComponent</a>(component_index1)),</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;        *affine_component2 =</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;        dynamic_cast&lt;const AffineComponent*&gt;(</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;            <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#aec8d6dfed3e4ab080d3ff4cf6a1126e3">GetComponent</a>(component_index2));</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    <span class="keywordflow">if</span> (affine_component2 == NULL ||</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;        (fixed_affine_component1 == NULL &amp;&amp; affine_component1 == NULL))</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    std::ostringstream new_component_name_os;</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    new_component_name_os &lt;&lt; <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a20a30bf0a11b6b83ba8837af06cf7d70">GetComponentName</a>(component_index1)</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;                          &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a20a30bf0a11b6b83ba8837af06cf7d70">GetComponentName</a>(component_index2);</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    std::string new_component_name = new_component_name_os.str();</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    int32 new_component_index = <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#aeffd575e42b6a1b9ff9842a2d3756966">GetComponentIndex</a>(new_component_name);</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    <span class="keywordflow">if</span> (new_component_index &gt;= 0)</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;      <span class="keywordflow">return</span> new_component_index;  <span class="comment">// we previously created this.</span></div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    <span class="keyword">const</span> CuMatrix&lt;BaseFloat&gt; *linear_params1;</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    <span class="keyword">const</span> CuVector&lt;BaseFloat&gt; *bias_params1;</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;    <span class="keywordflow">if</span> (fixed_affine_component1 != NULL) {</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;      <span class="keywordflow">if</span> (fixed_affine_component1-&gt;InputDim() &gt;</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;          fixed_affine_component1-&gt;OutputDim()) {</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;        <span class="comment">// first affine component is dimension-reducing, so combining the two</span></div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;        <span class="comment">// might be inefficient.</span></div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;      }</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;      linear_params1 = &amp;(fixed_affine_component1-&gt;LinearParams());</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;      bias_params1 = &amp;(fixed_affine_component1-&gt;BiasParams());</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;      <span class="keywordflow">if</span> (affine_component1-&gt;InputDim() &gt;</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;          affine_component1-&gt;OutputDim()) {</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;        <span class="comment">// first affine component is dimension-reducing, so combining the two</span></div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;        <span class="comment">// might be inefficient.</span></div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;      }</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;      linear_params1 = &amp;(affine_component1-&gt;LinearParams());</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;      bias_params1 = &amp;(affine_component1-&gt;BiasParams());</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;    }</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;    int32 input_dim1 = linear_params1-&gt;NumCols(),</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;        output_dim1 = linear_params1-&gt;NumRows(),</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;        input_dim2 = affine_component2-&gt;InputDim(),</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;        output_dim2 = affine_component2-&gt;OutputDim();</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(input_dim2 % output_dim1 == 0);</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;    <span class="comment">// with typical configurations for TDNNs, like Append(-3, 0, 3) [in xconfigs], a.k.a.</span></div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    <span class="comment">// Append(Offset(foo, -3), foo, Offset(foo, 3)), the first component&#39;s output may</span></div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;    <span class="comment">// be smaller than the second component&#39;s input.  We construct a single</span></div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;    <span class="comment">// transform with a block-diagonal structure in this case.</span></div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;    int32 multiple = input_dim2 / output_dim1;</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;    CuVector&lt;BaseFloat&gt; bias_params1_full(input_dim2);</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;    CuMatrix&lt;BaseFloat&gt; linear_params1_full(input_dim2,</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;                                            multiple * input_dim1);</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    <span class="keywordflow">for</span> (int32 <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; multiple; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;      bias_params1_full.Range(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> * output_dim1,</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;                              output_dim1).CopyFromVec(*bias_params1);</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;      linear_params1_full.Range(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> * output_dim1, output_dim1,</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;                                <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> * input_dim1, input_dim1).CopyFromMat(</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;                                    *linear_params1);</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    }</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    <span class="keyword">const</span> CuVector&lt;BaseFloat&gt; &amp;bias_params2 = affine_component2-&gt;BiasParams();</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    <span class="keyword">const</span> CuMatrix&lt;BaseFloat&gt; &amp;linear_params2 = affine_component2-&gt;LinearParams();</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    int32 new_input_dim = multiple * input_dim1,</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;        new_output_dim = output_dim2;</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    CuMatrix&lt;BaseFloat&gt; new_linear_params(new_output_dim,</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;                                          new_input_dim);</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;    CuVector&lt;BaseFloat&gt; new_bias_params(bias_params2);</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    new_bias_params.AddMatVec(1.0, linear_params2, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>,</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;                              bias_params1_full, 1.0);</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    new_linear_params.AddMatMat(1.0, linear_params2, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>,</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;                                linear_params1_full, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>, 0.0);</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    AffineComponent *new_component = <span class="keyword">new</span> AffineComponent();</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;    new_component-&gt;Init(new_input_dim, new_output_dim, 0.0, 0.0);</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;    new_component-&gt;SetParams(new_bias_params, new_linear_params);</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#ac7f6f24010db1c0731073ce601e03709">AddComponent</a>(new_component_name, new_component);</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;  }</div><div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_ac7f6f24010db1c0731073ce601e03709"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#ac7f6f24010db1c0731073ce601e03709">kaldi::nnet3::Nnet::AddComponent</a></div><div class="ttdeci">int32 AddComponent(const std::string &amp;name, Component *component)</div><div class="ttdoc">Adds a new component with the given name, which should not be the same as any existing component name...</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00161">nnet-nnet.cc:161</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_aeffd575e42b6a1b9ff9842a2d3756966"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#aeffd575e42b6a1b9ff9842a2d3756966">kaldi::nnet3::Nnet::GetComponentIndex</a></div><div class="ttdeci">int32 GetComponentIndex(const std::string &amp;node_name) const</div><div class="ttdoc">returns index associated with this component name, or -1 if no such index. </div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00474">nnet-nnet.cc:474</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ModelCollapser_html_ae6b2732bea7ce47719f18ad2b06d81d2"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">kaldi::nnet3::ModelCollapser::nnet_</a></div><div class="ttdeci">Nnet * nnet_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l02003">nnet-utils.cc:2003</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kaldi::kNoTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00034">matrix-common.h:34</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_a20a30bf0a11b6b83ba8837af06cf7d70"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#a20a30bf0a11b6b83ba8837af06cf7d70">kaldi::nnet3::Nnet::GetComponentName</a></div><div class="ttdeci">const std::string &amp; GetComponentName(int32 component_index) const</div><div class="ttdoc">returns individual component name. </div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00689">nnet-nnet.cc:689</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_aec8d6dfed3e4ab080d3ff4cf6a1126e3"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#aec8d6dfed3e4ab080d3ff4cf6a1126e3">kaldi::nnet3::Nnet::GetComponent</a></div><div class="ttdeci">Component * GetComponent(int32 c)</div><div class="ttdoc">Return component indexed c. Not a copy; not owned by caller. </div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00150">nnet-nnet.cc:150</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a47af881dbac6fd811414d7e6487c7bbb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47af881dbac6fd811414d7e6487c7bbb">&#9670;&nbsp;</a></span>CollapseComponentsBatchnorm()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int32 CollapseComponentsBatchnorm </td>
          <td>(</td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>component_index1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>component_index2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Tries to produce a component that's equivalent to running the component 'component_index2' with input given by 'component_index1'. </p>
<p>This handles the case where 'component_index1' is of type BatchnormComponent, and where 'component_index2' is of type <a class="el" href="classkaldi_1_1nnet3_1_1AffineComponent.html">AffineComponent</a> or <a class="el" href="classkaldi_1_1nnet3_1_1NaturalGradientAffineComponent.html">NaturalGradientAffineComponent</a>.</p>
<p>Returns -1 if this code can't produce a combined component (normally because the components have the wrong types). </p>

<p class="definition">Definition at line <a class="el" href="nnet-utils_8cc_source.html#l01639">1639</a> of file <a class="el" href="nnet-utils_8cc_source.html">nnet-utils.cc</a>.</p>

<p class="reference">References <a class="el" href="_2nnet-nnet_8cc_source.html#l00150">Nnet::GetComponent()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00689">Nnet::GetComponentName()</a>, <a class="el" href="kaldi-error_8h_source.html#l00126">KALDI_ERR</a>, <a class="el" href="nnet-utils_8cc_source.html#l00882">SvdApplier::nnet_</a>, <a class="el" href="nnet-normalize-component_8h_source.html#l00224">BatchNormComponent::Offset()</a>, and <a class="el" href="nnet-normalize-component_8cc_source.html#l00642">BatchNormComponent::Scale()</a>.</p>
<div class="fragment"><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;                                                            {</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;    <span class="keyword">const</span> BatchNormComponent *batchnorm_component =</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;        <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>BatchNormComponent*<span class="keyword">&gt;</span>(</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;            <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#aec8d6dfed3e4ab080d3ff4cf6a1126e3">GetComponent</a>(component_index1));</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    <span class="keywordflow">if</span> (batchnorm_component == NULL)</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;    <span class="keywordflow">if</span> (batchnorm_component-&gt;Offset().Dim() == 0) {</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Expected batch-norm components to have test-mode set.&quot;</span>;</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;    }</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    std::string batchnorm_component_name = <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a20a30bf0a11b6b83ba8837af06cf7d70">GetComponentName</a>(</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;        component_index1);</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#a74183a1452e88c063a63b1ec9119687d">GetDiagonallyPreModifiedComponentIndex</a>(batchnorm_component-&gt;Offset(),</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;                                                  batchnorm_component-&gt;Scale(),</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;                                                  batchnorm_component_name,</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;                                                  component_index2);</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;  }</div><div class="ttc" id="classkaldi_1_1nnet3_1_1ModelCollapser_html_a74183a1452e88c063a63b1ec9119687d"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ModelCollapser.html#a74183a1452e88c063a63b1ec9119687d">kaldi::nnet3::ModelCollapser::GetDiagonallyPreModifiedComponentIndex</a></div><div class="ttdeci">int32 GetDiagonallyPreModifiedComponentIndex(const CuVectorBase&lt; BaseFloat &gt; &amp;offset, const CuVectorBase&lt; BaseFloat &gt; &amp;scale, const std::string &amp;src_identifier, int32 component_index)</div><div class="ttdoc">This function finds, or creates, a component which is like &amp;#39;component_index&amp;#39; but is combined with a d...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l01841">nnet-utils.cc:1841</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ModelCollapser_html_ae6b2732bea7ce47719f18ad2b06d81d2"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">kaldi::nnet3::ModelCollapser::nnet_</a></div><div class="ttdeci">Nnet * nnet_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l02003">nnet-utils.cc:2003</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00126">kaldi-error.h:126</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_a20a30bf0a11b6b83ba8837af06cf7d70"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#a20a30bf0a11b6b83ba8837af06cf7d70">kaldi::nnet3::Nnet::GetComponentName</a></div><div class="ttdeci">const std::string &amp; GetComponentName(int32 component_index) const</div><div class="ttdoc">returns individual component name. </div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00689">nnet-nnet.cc:689</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_aec8d6dfed3e4ab080d3ff4cf6a1126e3"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#aec8d6dfed3e4ab080d3ff4cf6a1126e3">kaldi::nnet3::Nnet::GetComponent</a></div><div class="ttdeci">Component * GetComponent(int32 c)</div><div class="ttdoc">Return component indexed c. Not a copy; not owned by caller. </div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00150">nnet-nnet.cc:150</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3ca02a1c32e54f7644650710b881c551"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ca02a1c32e54f7644650710b881c551">&#9670;&nbsp;</a></span>CollapseComponentsDropout()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int32 CollapseComponentsDropout </td>
          <td>(</td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>component_index1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>component_index2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Tries to produce a component that's equivalent to running the component 'component_index2' with input given by 'component_index1'. </p>
<p>This handles the case where 'component_index1' is of type <a class="el" href="classkaldi_1_1nnet3_1_1DropoutComponent.html">DropoutComponent</a> or <a class="el" href="classkaldi_1_1nnet3_1_1GeneralDropoutComponent.html" title="GeneralDropoutComponent implements dropout, including a continuous variant where the thing we multipl...">GeneralDropoutComponent</a>, and where 'component_index2' is of type <a class="el" href="classkaldi_1_1nnet3_1_1AffineComponent.html">AffineComponent</a>, <a class="el" href="classkaldi_1_1nnet3_1_1NaturalGradientAffineComponent.html">NaturalGradientAffineComponent</a>, <a class="el" href="classkaldi_1_1nnet3_1_1LinearComponent.html">LinearComponent</a>, <a class="el" href="classkaldi_1_1nnet3_1_1TdnnComponent.html" title="TdnnComponent is a more memory-efficient alternative to manually splicing several frames of input and...">TdnnComponent</a> or <a class="el" href="classkaldi_1_1nnet3_1_1TimeHeightConvolutionComponent.html" title="TimeHeightConvolutionComponent implements 2-dimensional convolution where one of the dimensions of co...">TimeHeightConvolutionComponent</a>.</p>
<p>Returns -1 if this code can't produce a combined component (normally because the components have the wrong types). </p>

<p class="definition">Definition at line <a class="el" href="nnet-utils_8cc_source.html#l01599">1599</a> of file <a class="el" href="nnet-utils_8cc_source.html">nnet-utils.cc</a>.</p>

<p class="reference">References <a class="el" href="nnet-simple-component_8h_source.html#l00144">DropoutComponent::DropoutProportion()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00150">Nnet::GetComponent()</a>, and <a class="el" href="nnet-utils_8cc_source.html#l00882">SvdApplier::nnet_</a>.</p>
<div class="fragment"><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;                                                          {</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    <span class="keyword">const</span> DropoutComponent *dropout_component =</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;        <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>DropoutComponent*<span class="keyword">&gt;</span>(</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;            <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#aec8d6dfed3e4ab080d3ff4cf6a1126e3">GetComponent</a>(component_index1));</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;    <span class="keyword">const</span> GeneralDropoutComponent *general_dropout_component =</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;        <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>GeneralDropoutComponent*<span class="keyword">&gt;</span>(</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;            <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#aec8d6dfed3e4ab080d3ff4cf6a1126e3">GetComponent</a>(component_index1));</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;    <span class="keywordflow">if</span> (dropout_component == NULL &amp;&amp; general_dropout_component == NULL)</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> scale;  <span class="comment">// the scale we have to apply to correct for removing</span></div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;                      <span class="comment">// this dropout comonent.</span></div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    <span class="keywordflow">if</span> (dropout_component != NULL) {</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;      <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> dropout_proportion = dropout_component-&gt;DropoutProportion();</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;      scale = 1.0 / (1.0 - dropout_proportion);</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;      <span class="comment">// for GeneralDropoutComponent, it&#39;s done in such a way that the expectation</span></div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;      <span class="comment">// is always 1.  (When it&#39;s nonzero, we give it a value 1/(1-dropout_proportion).</span></div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;      <span class="comment">// So no scaling is needed.</span></div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;      scale = 1.0;</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;    }</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;    <span class="comment">// note: if the 2nd component is not of a type that we can scale, the</span></div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;    <span class="comment">// following function call will return -1, which is OK.</span></div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ab76ab5aac5135489b01f373372ee0e3a">GetScaledComponentIndex</a>(component_index2,</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;                                   scale);</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;  }</div><div class="ttc" id="namespacekaldi_html_aa66ff8367094543664b3b6a13d77c139"><div class="ttname"><a href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">kaldi::BaseFloat</a></div><div class="ttdeci">float BaseFloat</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00029">kaldi-types.h:29</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ModelCollapser_html_ae6b2732bea7ce47719f18ad2b06d81d2"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">kaldi::nnet3::ModelCollapser::nnet_</a></div><div class="ttdeci">Nnet * nnet_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l02003">nnet-utils.cc:2003</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ModelCollapser_html_ab76ab5aac5135489b01f373372ee0e3a"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ab76ab5aac5135489b01f373372ee0e3a">kaldi::nnet3::ModelCollapser::GetScaledComponentIndex</a></div><div class="ttdeci">int32 GetScaledComponentIndex(int32 component_index, BaseFloat scale)</div><div class="ttdoc">Given a component &amp;#39;component_index&amp;#39;, returns a component which will give the same output as the curre...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l01957">nnet-utils.cc:1957</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_aec8d6dfed3e4ab080d3ff4cf6a1126e3"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#aec8d6dfed3e4ab080d3ff4cf6a1126e3">kaldi::nnet3::Nnet::GetComponent</a></div><div class="ttdeci">Component * GetComponent(int32 c)</div><div class="ttdoc">Return component indexed c. Not a copy; not owned by caller. </div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00150">nnet-nnet.cc:150</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a03db4a58d5e01d5a7f0f964d9575e7f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03db4a58d5e01d5a7f0f964d9575e7f5">&#9670;&nbsp;</a></span>CollapseComponentsScale()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int32 CollapseComponentsScale </td>
          <td>(</td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>component_index1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>component_index2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Tries to produce a component that's equivalent to running the component 'component_index2' with input given by 'component_index1'. </p>
<p>This handles the case where 'component_index1' is of type <a class="el" href="classkaldi_1_1nnet3_1_1AffineComponent.html">AffineComponent</a> or <a class="el" href="classkaldi_1_1nnet3_1_1NaturalGradientAffineComponent.html">NaturalGradientAffineComponent</a>, and 'component_index2' is of type <a class="el" href="classkaldi_1_1nnet3_1_1FixedScaleComponent.html" title="FixedScaleComponent applies a fixed per-element scale; it&#39;s similar to the Rescale component in the n...">FixedScaleComponent</a>, and the output dim of the first is the same as the input dim of the second. This situation is common in output layers. Later if it's needed, we could easily enable the code to support <a class="el" href="classkaldi_1_1nnet3_1_1PerElementScaleComponent.html" title="PerElementScaleComponent scales each dimension of its input with a separate trainable scale; it&#39;s lik...">PerElementScaleComponent</a>.</p>
<p>Returns -1 if this code can't produce a combined component. </p>

<p class="definition">Definition at line <a class="el" href="nnet-utils_8cc_source.html#l01767">1767</a> of file <a class="el" href="nnet-utils_8cc_source.html">nnet-utils.cc</a>.</p>

<p class="reference">References <a class="el" href="_2nnet-nnet_8cc_source.html#l00161">Nnet::AddComponent()</a>, <a class="el" href="nnet-simple-component_8h_source.html#l00455">AffineComponent::BiasParams()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l01165">AffineComponent::Copy()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00150">Nnet::GetComponent()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00474">Nnet::GetComponentIndex()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00689">Nnet::GetComponentName()</a>, <a class="el" href="nnet-simple-component_8h_source.html#l01112">FixedScaleComponent::InputDim()</a>, <a class="el" href="nnet-simple-component_8h_source.html#l00457">AffineComponent::LinearParams()</a>, <a class="el" href="nnet-utils_8cc_source.html#l00882">SvdApplier::nnet_</a>, <a class="el" href="nnet-simple-component_8h_source.html#l00409">AffineComponent::OutputDim()</a>, <a class="el" href="nnet-simple-component_8h_source.html#l01130">FixedScaleComponent::Scales()</a>, and <a class="el" href="nnet-simple-component_8cc_source.html#l01134">AffineComponent::SetParams()</a>.</p>
<div class="fragment"><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;                                                        {</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    <span class="keyword">const</span> AffineComponent *affine_component1 =</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;        <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>AffineComponent*<span class="keyword">&gt;</span>(</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;            <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#aec8d6dfed3e4ab080d3ff4cf6a1126e3">GetComponent</a>(component_index1));</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;    <span class="keyword">const</span> FixedScaleComponent *fixed_scale_component2 =</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;        <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>FixedScaleComponent*<span class="keyword">&gt;</span>(</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;                    <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#aec8d6dfed3e4ab080d3ff4cf6a1126e3">GetComponent</a>(component_index2));</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;    <span class="keywordflow">if</span> (affine_component1 == NULL ||</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;        fixed_scale_component2 == NULL ||</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;        affine_component1-&gt;OutputDim() !=</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;        fixed_scale_component2-&gt;InputDim())</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;    std::ostringstream new_component_name_os;</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;    new_component_name_os &lt;&lt; <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a20a30bf0a11b6b83ba8837af06cf7d70">GetComponentName</a>(component_index1)</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;                          &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a20a30bf0a11b6b83ba8837af06cf7d70">GetComponentName</a>(component_index2);</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;    std::string new_component_name = new_component_name_os.str();</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    int32 new_component_index = <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#aeffd575e42b6a1b9ff9842a2d3756966">GetComponentIndex</a>(new_component_name);</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;    <span class="keywordflow">if</span> (new_component_index &gt;= 0)</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;      <span class="keywordflow">return</span> new_component_index;  <span class="comment">// we previously created this.</span></div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;    CuMatrix&lt;BaseFloat&gt; linear_params(affine_component1-&gt;LinearParams());</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;    CuVector&lt;BaseFloat&gt; bias_params(affine_component1-&gt;BiasParams());</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;    <span class="keyword">const</span> CuVector&lt;BaseFloat&gt; &amp;scales = fixed_scale_component2-&gt;Scales();</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;    bias_params.MulElements(scales);</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;    linear_params.MulRowsVec(scales);</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;    AffineComponent *new_affine_component =</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;        <span class="keyword">dynamic_cast&lt;</span>AffineComponent*<span class="keyword">&gt;</span>(affine_component1-&gt;Copy());</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;    new_affine_component-&gt;SetParams(bias_params, linear_params);</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#ac7f6f24010db1c0731073ce601e03709">AddComponent</a>(new_component_name,</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;                               new_affine_component);</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;  }</div><div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_ac7f6f24010db1c0731073ce601e03709"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#ac7f6f24010db1c0731073ce601e03709">kaldi::nnet3::Nnet::AddComponent</a></div><div class="ttdeci">int32 AddComponent(const std::string &amp;name, Component *component)</div><div class="ttdoc">Adds a new component with the given name, which should not be the same as any existing component name...</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00161">nnet-nnet.cc:161</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_aeffd575e42b6a1b9ff9842a2d3756966"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#aeffd575e42b6a1b9ff9842a2d3756966">kaldi::nnet3::Nnet::GetComponentIndex</a></div><div class="ttdeci">int32 GetComponentIndex(const std::string &amp;node_name) const</div><div class="ttdoc">returns index associated with this component name, or -1 if no such index. </div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00474">nnet-nnet.cc:474</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ModelCollapser_html_ae6b2732bea7ce47719f18ad2b06d81d2"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">kaldi::nnet3::ModelCollapser::nnet_</a></div><div class="ttdeci">Nnet * nnet_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l02003">nnet-utils.cc:2003</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_a20a30bf0a11b6b83ba8837af06cf7d70"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#a20a30bf0a11b6b83ba8837af06cf7d70">kaldi::nnet3::Nnet::GetComponentName</a></div><div class="ttdeci">const std::string &amp; GetComponentName(int32 component_index) const</div><div class="ttdoc">returns individual component name. </div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00689">nnet-nnet.cc:689</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_aec8d6dfed3e4ab080d3ff4cf6a1126e3"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#aec8d6dfed3e4ab080d3ff4cf6a1126e3">kaldi::nnet3::Nnet::GetComponent</a></div><div class="ttdeci">Component * GetComponent(int32 c)</div><div class="ttdoc">Return component indexed c. Not a copy; not owned by caller. </div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00150">nnet-nnet.cc:150</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a14b74ea006010f7b526a63ef19ab8750"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14b74ea006010f7b526a63ef19ab8750">&#9670;&nbsp;</a></span>DescriptorIsCollapsible()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int32 DescriptorIsCollapsible </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1nnet3_1_1Descriptor.html">Descriptor</a> &amp;&#160;</td>
          <td class="paramname"><em>desc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-utils_8cc_source.html#l01459">1459</a> of file <a class="el" href="nnet-utils_8cc_source.html">nnet-utils.cc</a>.</p>

<p class="reference">References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="nnet-descriptor_8h_source.html#l00583">Descriptor::NumParts()</a>, and <a class="el" href="nnet-descriptor_8cc_source.html#l00572">Descriptor::Part()</a>.</p>
<div class="fragment"><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;                                                        {</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    int32 ans = <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#a74229f66155b91205418f6cbffab377b">SumDescriptorIsCollapsible</a>(desc.Part(0));</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    <span class="keywordflow">for</span> (int32 <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 1; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; desc.NumParts(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;      <span class="keywordflow">if</span> (ans != -1) {</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;        int32 node_index = <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#a74229f66155b91205418f6cbffab377b">SumDescriptorIsCollapsible</a>(desc.Part(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;        <span class="keywordflow">if</span> (node_index != ans)</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;          ans = -1;</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;      }</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    }</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    <span class="comment">// note: ans is only &gt;= 0 if the answers from all parts of</span></div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    <span class="comment">// the SumDescriptors were &gt;=0 and identical to each other.</span></div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    <span class="comment">// Otherwise it will be -1.</span></div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    <span class="keywordflow">return</span> ans;</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;  }</div><div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ModelCollapser_html_a74229f66155b91205418f6cbffab377b"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ModelCollapser.html#a74229f66155b91205418f6cbffab377b">kaldi::nnet3::ModelCollapser::SumDescriptorIsCollapsible</a></div><div class="ttdeci">int32 SumDescriptorIsCollapsible(const SumDescriptor &amp;sum_desc)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l01431">nnet-utils.cc:1431</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a74183a1452e88c063a63b1ec9119687d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74183a1452e88c063a63b1ec9119687d">&#9670;&nbsp;</a></span>GetDiagonallyPreModifiedComponentIndex()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int32 GetDiagonallyPreModifiedComponentIndex </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>src_identifier</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>component_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function finds, or creates, a component which is like 'component_index' but is combined with a diagonal offset-and-scale transform *before* the component. </p>
<p>(We may later create a function called GetDiagonallyPostModifiedComponentIndex if we need to apply the transform *after* the component.</p>
<p>This function doesn't work for convolutional components, because due to zero-padding, it's not possible to represent an offset/scale on the input filters via changes in the convolutional parameters. [the scale, yes; but we don't bother doing that.]</p>
<p>This may require modifying its linear and bias parameters.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">offset</td><td>The offset term 'b' in the diagnonal transform y = a x + b. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">scale</td><td>The scale term 'a' in the diagnonal transform y = a x + b. Must have the same dimension as 'offset'. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">src_identifier</td><td>A string that uniquely identifies 'offset' and 'scale'. In practice it will be the component-index from where 'offset' and 'scale' were taken.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">component_index</td><td>The component to be modified (not in-place, but as a copy). The component described in 'component_index' must be <a class="el" href="classkaldi_1_1nnet3_1_1AffineComponent.html">AffineComponent</a>, <a class="el" href="classkaldi_1_1nnet3_1_1NaturalGradientAffineComponent.html">NaturalGradientAffineComponent</a>, <a class="el" href="classkaldi_1_1nnet3_1_1LinearComponent.html">LinearComponent</a> or <a class="el" href="classkaldi_1_1nnet3_1_1TdnnComponent.html" title="TdnnComponent is a more memory-efficient alternative to manually splicing several frames of input and...">TdnnComponent</a>, and the dimension of 'offset'/'scale' should divide the component input dimension, otherwise it's an error. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns the component-index of a suitably modified component. If one like this already exists, the existing one will be returned. If the component in 'component_index' was not of a type that can be modified in this way, returns -1. </dd></dl>

<p class="definition">Definition at line <a class="el" href="nnet-utils_8cc_source.html#l01841">1841</a> of file <a class="el" href="nnet-utils_8cc_source.html">nnet-utils.cc</a>.</p>

<p class="reference">References <a class="el" href="_2nnet-nnet_8cc_source.html#l00161">Nnet::AddComponent()</a>, <a class="el" href="nnet-simple-component_8h_source.html#l00455">AffineComponent::BiasParams()</a>, <a class="el" href="_2nnet-convolutional-component_8h_source.html#l00558">TdnnComponent::BiasParams()</a>, <a class="el" href="nnet-utils_8cc_source.html#l00864">SvdApplier::ModifiedComponentInfo::component_index</a>, <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#aa46d9c7de00be8203e16a6e55af0afef">Component::Copy()</a>, <a class="el" href="_2nnet-convolutional-component_8h_source.html#l00486">TdnnComponent::Copy()</a>, <a class="el" href="cu-vector_8h_source.html#l00068">CuVectorBase&lt; Real &gt;::Dim()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00150">Nnet::GetComponent()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00474">Nnet::GetComponentIndex()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00689">Nnet::GetComponentName()</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00505">UpdatableComponent::LearningRate()</a>, <a class="el" href="nnet-simple-component_8h_source.html#l00457">AffineComponent::LinearParams()</a>, <a class="el" href="_2nnet-convolutional-component_8h_source.html#l00554">TdnnComponent::LinearParams()</a>, <a class="el" href="cu-vector_8cc_source.html#l00754">CuVectorBase&lt; Real &gt;::Max()</a>, <a class="el" href="cu-vector_8cc_source.html#l00716">CuVectorBase&lt; Real &gt;::Min()</a>, <a class="el" href="nnet-utils_8cc_source.html#l00882">SvdApplier::nnet_</a>, <a class="el" href="_2nnet-convolutional-component_8h_source.html#l00462">TdnnComponent::OutputDim()</a>, <a class="el" href="nnet-simple-component_8h_source.html#l00930">LinearComponent::OutputDim()</a>, and <a class="el" href="nnet-simple-component_8h_source.html#l00972">LinearComponent::Params()</a>.</p>
<div class="fragment"><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;                             {</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(offset.Dim() &gt; 0 &amp;&amp; offset.Dim() == scale.Dim());</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    <span class="keywordflow">if</span> (offset.Max() == 0.0 &amp;&amp; offset.Min() == 0.0 &amp;&amp;</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;        scale.Max() == 1.0 &amp;&amp; scale.Min() == 1.0)</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;      <span class="keywordflow">return</span> component_index;  <span class="comment">// identity transform.</span></div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    std::ostringstream new_component_name_os;</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;    new_component_name_os &lt;&lt; src_identifier</div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;                          &lt;&lt; <span class="stringliteral">&quot;.&quot;</span></div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;                          &lt;&lt; <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a20a30bf0a11b6b83ba8837af06cf7d70">GetComponentName</a>(component_index);</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;    std::string new_component_name = new_component_name_os.str();</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;    int32 new_component_index = <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#aeffd575e42b6a1b9ff9842a2d3756966">GetComponentIndex</a>(new_component_name);</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    <span class="keywordflow">if</span> (new_component_index &gt;= 0)</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;      <span class="keywordflow">return</span> new_component_index;  <span class="comment">// we previously created this.</span></div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;    <span class="keyword">const</span> Component *component = <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#aec8d6dfed3e4ab080d3ff4cf6a1126e3">GetComponent</a>(component_index);</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;    <span class="keyword">const</span> AffineComponent *affine_component =</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;        <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>AffineComponent*<span class="keyword">&gt;</span>(component);</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;    <span class="keyword">const</span> LinearComponent *linear_component =</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;        <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>LinearComponent*<span class="keyword">&gt;</span>(component);</div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;    <span class="keyword">const</span> TdnnComponent *tdnn_component =</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;        <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>TdnnComponent*<span class="keyword">&gt;</span>(component);</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;    Component *new_component = NULL;</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;    <span class="keywordflow">if</span> (affine_component != NULL) {</div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;      new_component = component-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#aa46d9c7de00be8203e16a6e55af0afef">Copy</a>();</div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;      AffineComponent *new_affine_component =</div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;          <span class="keyword">dynamic_cast&lt;</span>AffineComponent*<span class="keyword">&gt;</span>(new_component);</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;      <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#af8944368b3f6af35487ea58c57c62bd1">PreMultiplyAffineParameters</a>(offset, scale,</div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;                                  &amp;(new_affine_component-&gt;BiasParams()),</div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;                                  &amp;(new_affine_component-&gt;LinearParams()));</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (linear_component != NULL) {</div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;      CuVector&lt;BaseFloat&gt; bias_params(linear_component-&gt;OutputDim());</div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;      AffineComponent *new_affine_component =</div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;          <span class="keyword">new</span> AffineComponent(linear_component-&gt;Params(),</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;                              bias_params,</div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;                              linear_component-&gt;LearningRate());</div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;      <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#af8944368b3f6af35487ea58c57c62bd1">PreMultiplyAffineParameters</a>(offset, scale,</div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;                                  &amp;(new_affine_component-&gt;BiasParams()),</div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;                                  &amp;(new_affine_component-&gt;LinearParams()));</div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;      new_component = new_affine_component;</div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tdnn_component != NULL) {</div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;      new_component = tdnn_component-&gt;Copy();</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;      TdnnComponent *new_tdnn_component =</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;          <span class="keyword">dynamic_cast&lt;</span>TdnnComponent*<span class="keyword">&gt;</span>(new_component);</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;      <span class="keywordflow">if</span> (new_tdnn_component-&gt;BiasParams().Dim() == 0) {</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;        <span class="comment">// make sure it has a bias even if it had none before.</span></div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;        new_tdnn_component-&gt;BiasParams().Resize(</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;            new_tdnn_component-&gt;OutputDim());</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;      }</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;      <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#af8944368b3f6af35487ea58c57c62bd1">PreMultiplyAffineParameters</a>(offset, scale,</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;                                  &amp;(new_tdnn_component-&gt;BiasParams()),</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;                                  &amp;(new_tdnn_component-&gt;LinearParams()));</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;      <span class="keywordflow">return</span> -1;  <span class="comment">// we can&#39;t do this: this component isn&#39;t of the right type.</span></div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;    }</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#ac7f6f24010db1c0731073ce601e03709">AddComponent</a>(new_component_name, new_component);</div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;  }</div><div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_ac7f6f24010db1c0731073ce601e03709"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#ac7f6f24010db1c0731073ce601e03709">kaldi::nnet3::Nnet::AddComponent</a></div><div class="ttdeci">int32 AddComponent(const std::string &amp;name, Component *component)</div><div class="ttdoc">Adds a new component with the given name, which should not be the same as any existing component name...</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00161">nnet-nnet.cc:161</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html_aa46d9c7de00be8203e16a6e55af0afef"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html#aa46d9c7de00be8203e16a6e55af0afef">kaldi::nnet3::Component::Copy</a></div><div class="ttdeci">virtual Component * Copy() const =0</div><div class="ttdoc">Copies component (deep copy). </div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ModelCollapser_html_af8944368b3f6af35487ea58c57c62bd1"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ModelCollapser.html#af8944368b3f6af35487ea58c57c62bd1">kaldi::nnet3::ModelCollapser::PreMultiplyAffineParameters</a></div><div class="ttdeci">static void PreMultiplyAffineParameters(const CuVectorBase&lt; BaseFloat &gt; &amp;offset, const CuVectorBase&lt; BaseFloat &gt; &amp;scale, CuVectorBase&lt; BaseFloat &gt; *bias_params, CuMatrixBase&lt; BaseFloat &gt; *linear_params)</div><div class="ttdoc">This helper function, used GetDiagonallyPreModifiedComponentIndex, modifies the linear and bias param...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l01913">nnet-utils.cc:1913</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_aeffd575e42b6a1b9ff9842a2d3756966"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#aeffd575e42b6a1b9ff9842a2d3756966">kaldi::nnet3::Nnet::GetComponentIndex</a></div><div class="ttdeci">int32 GetComponentIndex(const std::string &amp;node_name) const</div><div class="ttdoc">returns index associated with this component name, or -1 if no such index. </div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00474">nnet-nnet.cc:474</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ModelCollapser_html_ae6b2732bea7ce47719f18ad2b06d81d2"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">kaldi::nnet3::ModelCollapser::nnet_</a></div><div class="ttdeci">Nnet * nnet_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l02003">nnet-utils.cc:2003</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_a20a30bf0a11b6b83ba8837af06cf7d70"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#a20a30bf0a11b6b83ba8837af06cf7d70">kaldi::nnet3::Nnet::GetComponentName</a></div><div class="ttdeci">const std::string &amp; GetComponentName(int32 component_index) const</div><div class="ttdoc">returns individual component name. </div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00689">nnet-nnet.cc:689</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_aec8d6dfed3e4ab080d3ff4cf6a1126e3"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#aec8d6dfed3e4ab080d3ff4cf6a1126e3">kaldi::nnet3::Nnet::GetComponent</a></div><div class="ttdeci">Component * GetComponent(int32 c)</div><div class="ttdoc">Return component indexed c. Not a copy; not owned by caller. </div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00150">nnet-nnet.cc:150</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab76ab5aac5135489b01f373372ee0e3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab76ab5aac5135489b01f373372ee0e3a">&#9670;&nbsp;</a></span>GetScaledComponentIndex()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int32 GetScaledComponentIndex </td>
          <td>(</td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>component_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a>&#160;</td>
          <td class="paramname"><em>scale</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Given a component 'component_index', returns a component which will give the same output as the current component gives when its input is scaled by 'scale'. </p>
<p>This will generally mean applying the scale to the linear parameters in the component, if it is an affine, linear or convolutional component.</p>
<p>If the component referred to in 'component_index' is not an affine or convolutional component, and therefore cannot be scaled (by this code), then this function returns -1. </p>

<p class="definition">Definition at line <a class="el" href="nnet-utils_8cc_source.html#l01957">1957</a> of file <a class="el" href="nnet-utils_8cc_source.html">nnet-utils.cc</a>.</p>

<p class="reference">References <a class="el" href="_2nnet-nnet_8cc_source.html#l00161">Nnet::AddComponent()</a>, <a class="el" href="nnet-utils_8cc_source.html#l00864">SvdApplier::ModifiedComponentInfo::component_index</a>, <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#aa46d9c7de00be8203e16a6e55af0afef">Component::Copy()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00150">Nnet::GetComponent()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00474">Nnet::GetComponentIndex()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00689">Nnet::GetComponentName()</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, <a class="el" href="nnet-utils_8cc_source.html#l00882">SvdApplier::nnet_</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l01092">AffineComponent::Scale()</a>, <a class="el" href="nnet-tdnn-component_8cc_source.html#l00597">TdnnComponent::Scale()</a>, and <a class="el" href="nnet-simple-component_8cc_source.html#l03282">LinearComponent::Scale()</a>.</p>
<div class="fragment"><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;                                                 {</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;    <span class="keywordflow">if</span> (scale == 1.0)</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;      <span class="keywordflow">return</span> component_index;</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;    std::ostringstream os;</div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;    os &lt;&lt; <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a20a30bf0a11b6b83ba8837af06cf7d70">GetComponentName</a>(component_index)</div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;.scale&quot;</span> &lt;&lt; std::setprecision(3) &lt;&lt; scale;</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;    std::string new_component_name = os.str();  <span class="comment">// e.g. foo.s2.0</span></div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;    int32 ans = <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#aeffd575e42b6a1b9ff9842a2d3756966">GetComponentIndex</a>(new_component_name);</div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;    <span class="keywordflow">if</span> (ans &gt;= 0)</div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;      <span class="keywordflow">return</span> ans;  <span class="comment">// one already exists, no need to create it.</span></div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;    <span class="keyword">const</span> Component *current_component = <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#aec8d6dfed3e4ab080d3ff4cf6a1126e3">GetComponent</a>(component_index);</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;    <span class="keyword">const</span> AffineComponent *affine_component =</div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;        <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>AffineComponent*<span class="keyword">&gt;</span>(current_component);</div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;    <span class="keyword">const</span> TimeHeightConvolutionComponent *conv_component =</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;        <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>TimeHeightConvolutionComponent*<span class="keyword">&gt;</span>(current_component);</div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;    <span class="keyword">const</span> LinearComponent *linear_component =</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;        <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>LinearComponent*<span class="keyword">&gt;</span>(current_component);</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;    <span class="keyword">const</span> TdnnComponent *tdnn_component =</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;        <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>TdnnComponent*<span class="keyword">&gt;</span>(current_component);</div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;    <span class="keywordflow">if</span> (affine_component == NULL &amp;&amp; conv_component == NULL &amp;&amp;</div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;        linear_component == NULL &amp;&amp; tdnn_component == NULL) {</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;      <span class="comment">// We can&#39;t scale this component (at least, not using this code).</span></div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;    }</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;    Component *new_component = current_component-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#aa46d9c7de00be8203e16a6e55af0afef">Copy</a>();</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;    <span class="keywordflow">if</span> (affine_component != NULL) {</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;      <span class="comment">// AffineComponent or NaturalGradientAffineComponent.</span></div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;      <span class="keyword">dynamic_cast&lt;</span>AffineComponent*<span class="keyword">&gt;</span>(new_component)-&gt;</div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;          LinearParams().<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#a750ca3e44a00898afea53b54697226ba">Scale</a>(scale);</div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (conv_component != NULL) {</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;      <span class="keyword">dynamic_cast&lt;</span>TimeHeightConvolutionComponent*<span class="keyword">&gt;</span>(new_component)-&gt;</div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;          ScaleLinearParams(scale);</div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (linear_component != NULL) {</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;      <span class="keyword">dynamic_cast&lt;</span>LinearComponent*<span class="keyword">&gt;</span>(new_component)-&gt;Params().Scale(scale);</div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(tdnn_component != NULL);</div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;      <span class="keyword">dynamic_cast&lt;</span>TdnnComponent*<span class="keyword">&gt;</span>(new_component)-&gt;LinearParams().Scale(scale);</div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;    }</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#ac7f6f24010db1c0731073ce601e03709">AddComponent</a>(new_component_name, new_component);</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;  }</div><div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_ac7f6f24010db1c0731073ce601e03709"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#ac7f6f24010db1c0731073ce601e03709">kaldi::nnet3::Nnet::AddComponent</a></div><div class="ttdeci">int32 AddComponent(const std::string &amp;name, Component *component)</div><div class="ttdoc">Adds a new component with the given name, which should not be the same as any existing component name...</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00161">nnet-nnet.cc:161</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html_aa46d9c7de00be8203e16a6e55af0afef"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html#aa46d9c7de00be8203e16a6e55af0afef">kaldi::nnet3::Component::Copy</a></div><div class="ttdeci">virtual Component * Copy() const =0</div><div class="ttdoc">Copies component (deep copy). </div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html_a750ca3e44a00898afea53b54697226ba"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html#a750ca3e44a00898afea53b54697226ba">kaldi::nnet3::Component::Scale</a></div><div class="ttdeci">virtual void Scale(BaseFloat scale)</div><div class="ttdoc">This virtual function when called on  an UpdatableComponent scales the parameters by &quot;scale&quot; when c...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00360">nnet-component-itf.h:360</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_aeffd575e42b6a1b9ff9842a2d3756966"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#aeffd575e42b6a1b9ff9842a2d3756966">kaldi::nnet3::Nnet::GetComponentIndex</a></div><div class="ttdeci">int32 GetComponentIndex(const std::string &amp;node_name) const</div><div class="ttdoc">returns index associated with this component name, or -1 if no such index. </div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00474">nnet-nnet.cc:474</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ModelCollapser_html_ae6b2732bea7ce47719f18ad2b06d81d2"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">kaldi::nnet3::ModelCollapser::nnet_</a></div><div class="ttdeci">Nnet * nnet_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l02003">nnet-utils.cc:2003</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_a20a30bf0a11b6b83ba8837af06cf7d70"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#a20a30bf0a11b6b83ba8837af06cf7d70">kaldi::nnet3::Nnet::GetComponentName</a></div><div class="ttdeci">const std::string &amp; GetComponentName(int32 component_index) const</div><div class="ttdoc">returns individual component name. </div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00689">nnet-nnet.cc:689</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_aec8d6dfed3e4ab080d3ff4cf6a1126e3"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#aec8d6dfed3e4ab080d3ff4cf6a1126e3">kaldi::nnet3::Nnet::GetComponent</a></div><div class="ttdeci">Component * GetComponent(int32 c)</div><div class="ttdoc">Return component indexed c. Not a copy; not owned by caller. </div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00150">nnet-nnet.cc:150</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8bf6036cd76aa5d866fc73433c6efd6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bf6036cd76aa5d866fc73433c6efd6f">&#9670;&nbsp;</a></span>OptimizeNode()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> OptimizeNode </td>
          <td>(</td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>node_index</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function modifies the neural network in the case where 'node_index' is a component-input node whose component (in the node at 'node_index + 1), if a bunch of other conditions also apply. </p>
<p>First, he descriptor in the node at 'node_index' has to have a certain limited structure, e.g.:</p><ul>
<li>the input-descriptor is a component-node name like 'foo' or:</li>
<li>the input-descriptor is a combination of Append and/or and Offset expressions, like: 'Append(Offset(foo, -3), foo, Offset(foo, 3))', referring to only a single node 'foo'.</li>
</ul>
<p>ALSO the components need to be collapsible by the function <a class="el" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ab0b55992607ac79a639c266301ee8a5b" title="This function tries to collapse two successive components, where the component &#39;component_index1&#39; app...">CollapseComponents()</a>, which will only be possible for certain pairs of component types (like, say, a dropout node preceding an affine or convolutional node); see that function for details.</p>
<p>This function will (if it does anything), modify the node to replace the component at 'node_index + 1' with a newly created component that combines the two components involved. It will also modify the node at 'node_index' by replacing its <a class="el" href="classkaldi_1_1nnet3_1_1Descriptor.html">Descriptor</a> with a modified input descriptor, so that if the input-descriptor of node 'foo' was 'bar', the descriptor for our node would now look like: 'Append(Offset(bar, -3), bar, Offset(bar, 3))'... and note that 'bar' itself doesn't have to be just a node-name, it can be a more general expression. This function returns true if it changed something in the neural net, and false otherwise. </p>

<p class="definition">Definition at line <a class="el" href="nnet-utils_8cc_source.html#l01544">1544</a> of file <a class="el" href="nnet-utils_8cc_source.html">nnet-utils.cc</a>.</p>

<p class="reference">References <a class="el" href="_2nnet-nnet_8h_source.html#l00087">NetworkNode::component_index</a>, <a class="el" href="nnet-utils_8cc_source.html#l00864">SvdApplier::ModifiedComponentInfo::component_index</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00084">NetworkNode::descriptor</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00146">Nnet::GetNode()</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00055">kaldi::nnet3::kComponent</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00055">kaldi::nnet3::kDescriptor</a>, <a class="el" href="nnet-utils_8cc_source.html#l00882">SvdApplier::nnet_</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00082">NetworkNode::node_type</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00126">Nnet::NumNodes()</a>, and <a class="el" href="structkaldi_1_1nnet3_1_1NetworkNode.html#a1350345f237cf9f9ce2f2e2b39800dd7">NetworkNode::u</a>.</p>
<div class="fragment"><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;                                      {</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;    NetworkNode &amp;descriptor_node = <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a7c9670858b79ae4a8e1c054b5d5231b8">GetNode</a>(node_index);</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    <span class="keywordflow">if</span> (descriptor_node.node_type != <a class="code" href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16af6fcd3c520d4fbd679b82fdf40a3ed8b">kDescriptor</a> ||</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;        node_index + 1 &gt;= <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a3213a214cf17e6fa16bc696b457545f3">NumNodes</a>())</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;    NetworkNode &amp;component_node = <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a7c9670858b79ae4a8e1c054b5d5231b8">GetNode</a>(node_index + 1);</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;    <span class="keywordflow">if</span> (component_node.node_type != <a class="code" href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16a02fee4c0e0e6f1b7ab7a678d61627461">kComponent</a>)</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;    Descriptor &amp;descriptor = descriptor_node.<a class="code" href="structkaldi_1_1nnet3_1_1NetworkNode.html#adb7a941ad767dbe68f14fd44169a47e5">descriptor</a>;</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;    int32 component_index = component_node.u.component_index;</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;    int32 input_node_index = <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#a14b74ea006010f7b526a63ef19ab8750">DescriptorIsCollapsible</a>(descriptor);</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;    <span class="keywordflow">if</span> (input_node_index == -1)</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;  <span class="comment">// do nothing, the expression in the Descriptor is too</span></div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;                     <span class="comment">// general for this code to handle.</span></div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;    <span class="keyword">const</span> NetworkNode &amp;input_node = <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a7c9670858b79ae4a8e1c054b5d5231b8">GetNode</a>(input_node_index);</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;    <span class="keywordflow">if</span> (input_node.node_type != <a class="code" href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16a02fee4c0e0e6f1b7ab7a678d61627461">kComponent</a>)</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;    int32 input_component_index = input_node.<a class="code" href="structkaldi_1_1nnet3_1_1NetworkNode.html#a1350345f237cf9f9ce2f2e2b39800dd7">u</a>.<a class="code" href="structkaldi_1_1nnet3_1_1NetworkNode.html#a270421a70b3bbf94bcad52d82772ed3c">component_index</a>;</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;    int32 combined_component_index = <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ab0b55992607ac79a639c266301ee8a5b">CollapseComponents</a>(input_component_index,</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;                                                        component_index);</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;    <span class="keywordflow">if</span> (combined_component_index == -1)</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;  <span class="comment">// these components were not of types that can be</span></div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;                     <span class="comment">// collapsed.</span></div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;    component_node.u.component_index = combined_component_index;</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    <span class="comment">// &#39;input_descriptor_node&#39; is the input descriptor of the component</span></div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;    <span class="comment">// that&#39;s the input to the node in &quot;node_index&quot;.  (e.g. the component for</span></div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;    <span class="comment">// the node &quot;foo&quot; in our example above).</span></div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    <span class="keyword">const</span> NetworkNode &amp;input_descriptor_node = <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a7c9670858b79ae4a8e1c054b5d5231b8">GetNode</a>(input_node_index - 1);</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;    <span class="keyword">const</span> Descriptor &amp;input_descriptor = input_descriptor_node.<a class="code" href="structkaldi_1_1nnet3_1_1NetworkNode.html#adb7a941ad767dbe68f14fd44169a47e5">descriptor</a>;</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;    <span class="comment">// The next statement replaces the descriptor in the network node with one</span></div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    <span class="comment">// in which the component &#39;input_component_index&#39; has been replaced with its</span></div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;    <span class="comment">// input, thus bypassing the component in &#39;input_component_index&#39;.</span></div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;    <span class="comment">// We&#39;ll later remove that component and its node from the network, if</span></div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;    <span class="comment">// needed by RemoveOrphanNodes() and RemoveOrphanComponents().</span></div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    descriptor = <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#a69e50be80095eb47492cc6ba87102707">ReplaceNodeInDescriptor</a>(descriptor,</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;                                         input_node_index,</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;                                         input_descriptor);</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;  }</div><div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_a3213a214cf17e6fa16bc696b457545f3"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#a3213a214cf17e6fa16bc696b457545f3">kaldi::nnet3::Nnet::NumNodes</a></div><div class="ttdeci">int32 NumNodes() const</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00126">nnet-nnet.h:126</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ModelCollapser_html_ab0b55992607ac79a639c266301ee8a5b"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ab0b55992607ac79a639c266301ee8a5b">kaldi::nnet3::ModelCollapser::CollapseComponents</a></div><div class="ttdeci">int32 CollapseComponents(int32 component_index1, int32 component_index2)</div><div class="ttdoc">This function tries to collapse two successive components, where the component &amp;#39;component_index1&amp;#39; app...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l01399">nnet-utils.cc:1399</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ModelCollapser_html_a14b74ea006010f7b526a63ef19ab8750"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ModelCollapser.html#a14b74ea006010f7b526a63ef19ab8750">kaldi::nnet3::ModelCollapser::DescriptorIsCollapsible</a></div><div class="ttdeci">int32 DescriptorIsCollapsible(const Descriptor &amp;desc)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l01459">nnet-utils.cc:1459</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NetworkNode_html_a270421a70b3bbf94bcad52d82772ed3c"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NetworkNode.html#a270421a70b3bbf94bcad52d82772ed3c">kaldi::nnet3::NetworkNode::component_index</a></div><div class="ttdeci">int32 component_index</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00087">nnet-nnet.h:87</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_a7c9670858b79ae4a8e1c054b5d5231b8"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#a7c9670858b79ae4a8e1c054b5d5231b8">kaldi::nnet3::Nnet::GetNode</a></div><div class="ttdeci">const NetworkNode &amp; GetNode(int32 node) const</div><div class="ttdoc">returns const reference to a particular numbered network node. </div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00146">nnet-nnet.h:146</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_acac9cbaeea226ed297804c012dc12b16a02fee4c0e0e6f1b7ab7a678d61627461"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16a02fee4c0e0e6f1b7ab7a678d61627461">kaldi::nnet3::kComponent</a></div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00055">nnet-nnet.h:55</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ModelCollapser_html_ae6b2732bea7ce47719f18ad2b06d81d2"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">kaldi::nnet3::ModelCollapser::nnet_</a></div><div class="ttdeci">Nnet * nnet_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l02003">nnet-utils.cc:2003</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_acac9cbaeea226ed297804c012dc12b16af6fcd3c520d4fbd679b82fdf40a3ed8b"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16af6fcd3c520d4fbd679b82fdf40a3ed8b">kaldi::nnet3::kDescriptor</a></div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00055">nnet-nnet.h:55</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ModelCollapser_html_a69e50be80095eb47492cc6ba87102707"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ModelCollapser.html#a69e50be80095eb47492cc6ba87102707">kaldi::nnet3::ModelCollapser::ReplaceNodeInDescriptor</a></div><div class="ttdeci">Descriptor ReplaceNodeInDescriptor(const Descriptor &amp;src, int32 node_to_replace, const Descriptor &amp;expr)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l01478">nnet-utils.cc:1478</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NetworkNode_html_adb7a941ad767dbe68f14fd44169a47e5"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NetworkNode.html#adb7a941ad767dbe68f14fd44169a47e5">kaldi::nnet3::NetworkNode::descriptor</a></div><div class="ttdeci">Descriptor descriptor</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00084">nnet-nnet.h:84</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NetworkNode_html_a1350345f237cf9f9ce2f2e2b39800dd7"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NetworkNode.html#a1350345f237cf9f9ce2f2e2b39800dd7">kaldi::nnet3::NetworkNode::u</a></div><div class="ttdeci">union kaldi::nnet3::NetworkNode::@14 u</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af8944368b3f6af35487ea58c57c62bd1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8944368b3f6af35487ea58c57c62bd1">&#9670;&nbsp;</a></span>PreMultiplyAffineParameters()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void PreMultiplyAffineParameters </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; *&#160;</td>
          <td class="paramname"><em>bias_params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; *&#160;</td>
          <td class="paramname"><em>linear_params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This helper function, used GetDiagonallyPreModifiedComponentIndex, modifies the linear and bias parameters of an affine transform to capture the effect of preceding that affine transform by a diagonal affine transform with parameters 'offset' and 'scale'. </p>
<p>The dimension of 'offset' and 'scale' must be the same and must divide the input dim of the affine transform, i.e. must divide linear_params-&gt;NumCols(). </p>

<p class="definition">Definition at line <a class="el" href="nnet-utils_8cc_source.html#l01913">1913</a> of file <a class="el" href="nnet-utils_8cc_source.html">nnet-utils.cc</a>.</p>

<p class="reference">References <a class="el" href="cu-vector_8cc_source.html#l00478">CuVectorBase&lt; Real &gt;::AddMatVec()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00064">rnnlm::d</a>, <a class="el" href="cu-vector_8h_source.html#l00068">CuVectorBase&lt; Real &gt;::Dim()</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, <a class="el" href="matrix-common_8h_source.html#l00034">kaldi::kNoTrans</a>, <a class="el" href="cu-matrix_8cc_source.html#l00752">CuMatrixBase&lt; Real &gt;::MulColsVec()</a>, <a class="el" href="cu-matrix_8h_source.html#l00215">CuMatrixBase&lt; Real &gt;::NumCols()</a>, and <a class="el" href="cu-matrix_8h_source.html#l00214">CuMatrixBase&lt; Real &gt;::NumRows()</a>.</p>
<div class="fragment"><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;                                              {</div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;    int32 input_dim = linear_params-&gt;NumCols(),</div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;        transform_dim = offset.Dim();</div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(bias_params-&gt;Dim() == linear_params-&gt;NumRows() &amp;&amp;</div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;                 offset.Dim() == scale.Dim() &amp;&amp;</div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;                 input_dim % transform_dim == 0);</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;    <span class="comment">// we may have to repeat &#39;offset&#39; and scale&#39; several times.</span></div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;    <span class="comment">// &#39;full_offset&#39; and &#39;full_scale&#39; may be repeated versions of</span></div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;    <span class="comment">// &#39;offset&#39; and &#39;scale&#39; in case input_dim &gt; transform_dim.</span></div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;    CuVector&lt;BaseFloat&gt; full_offset(input_dim),</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;        full_scale(input_dim);</div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;    <span class="keywordflow">for</span> (int32 <a class="code" href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> = 0; <a class="code" href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> &lt; input_dim; <a class="code" href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> += transform_dim) {</div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;      full_offset.Range(<a class="code" href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">d</a>, transform_dim).CopyFromVec(offset);</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;      full_scale.Range(<a class="code" href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">d</a>, transform_dim).CopyFromVec(scale);</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;    }</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;    <span class="comment">// Image the affine component does y = a x + b, and by applying</span></div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;    <span class="comment">// the pre-transform we are replacing x with s x + o</span></div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;    <span class="comment">// s for scale and o for offset), so we have:</span></div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;    <span class="comment">//  y = a s x + (b + a o).</span></div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;    <span class="comment">// do: b += a o.</span></div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;    bias_params-&gt;AddMatVec(1.0, *linear_params, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>, full_offset, 1.0);</div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;    <span class="comment">// do: a = a * s.</span></div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;    linear_params-&gt;MulColsVec(full_scale);</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;</div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;</div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;  }</div><div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kaldi::kNoTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00034">matrix-common.h:34</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="namespacernnlm_html_a873684cefeb665f3d5e6b495de57fc0d"><div class="ttname"><a href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">rnnlm::d</a></div><div class="ttdeci">double d</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00064">mikolov-rnnlm-lib.cc:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a69e50be80095eb47492cc6ba87102707"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69e50be80095eb47492cc6ba87102707">&#9670;&nbsp;</a></span>ReplaceNodeInDescriptor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1nnet3_1_1Descriptor.html">Descriptor</a> ReplaceNodeInDescriptor </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1nnet3_1_1Descriptor.html">Descriptor</a> &amp;&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>node_to_replace</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1nnet3_1_1Descriptor.html">Descriptor</a> &amp;&#160;</td>
          <td class="paramname"><em>expr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-utils_8cc_source.html#l01478">1478</a> of file <a class="el" href="nnet-utils_8cc_source.html">nnet-utils.cc</a>.</p>

<p class="reference">References <a class="el" href="nnet-parse_8cc_source.html#l00377">kaldi::nnet3::DescriptorTokenize()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00063">Nnet::GetNodeNames()</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, <a class="el" href="nnet-utils_8cc_source.html#l00882">SvdApplier::nnet_</a>, <a class="el" href="nnet-descriptor_8cc_source.html#l00491">Descriptor::Parse()</a>, and <a class="el" href="nnet-descriptor_8cc_source.html#l00510">Descriptor::WriteConfig()</a>.</p>
<div class="fragment"><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;                                                             {</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    <span class="comment">// The way we replace it is at the textual level: we create a &quot;fake&quot; vector</span></div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    <span class="comment">// of node-names where the printed form of &#39;expr&#39; appears as the</span></div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    <span class="comment">// node name in node_names[node_to_replace]; we print the descriptor</span></div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    <span class="comment">// in &#39;src&#39; using that faked node-names vector; and we parse it again</span></div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    <span class="comment">// using the real node-names vector.</span></div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    std::vector&lt;std::string&gt; node_names = <a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#ad535f900dadd2cbd357d0b6382a9bff6">GetNodeNames</a>();</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    std::ostringstream expr_os;</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    expr.WriteConfig(expr_os, node_names);</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    node_names[node_to_replace] = expr_os.str();</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    std::ostringstream src_replaced_os;</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    src.WriteConfig(src_replaced_os, node_names);</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;    std::vector&lt;std::string&gt; tokens;</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    <span class="comment">// now, in the example, src_replaced_os.str() would equal</span></div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    <span class="comment">//  Append(Offset(Offset(bar, -1), -1), Offset(Offset(bar, -1), 1)).</span></div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    <span class="keywordtype">bool</span> b = <a class="code" href="namespacekaldi_1_1nnet3.html#ac6b64008b19bbb6e8769769cbf96fa68">DescriptorTokenize</a>(src_replaced_os.str(),</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;                                  &amp;tokens);</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(b);</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    <span class="comment">// &#39;tokens&#39; might now contain something like [ &quot;Append&quot;, &quot;(&quot;, &quot;Offset&quot;, ..., &quot;)&quot; ].</span></div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;    tokens.push_back(<span class="stringliteral">&quot;end of input&quot;</span>);</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    <span class="keyword">const</span> std::string *next_token = &amp;(tokens[0]);</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    Descriptor ans;</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    <span class="comment">// parse using the un-modified node names.</span></div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    ans.Parse(<a class="code" href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#ad535f900dadd2cbd357d0b6382a9bff6">GetNodeNames</a>(), &amp;next_token);</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(*next_token == <span class="stringliteral">&quot;end of input&quot;</span>);</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    <span class="comment">// Note: normalization of expressions in Descriptors, such as conversion of</span></div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;    <span class="comment">// Offset(Offset(bar, -1), -1) to Offset(bar, -2), takes place inside the</span></div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;    <span class="comment">// Descriptor parsing code.</span></div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;    <span class="keywordflow">return</span> ans;</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;  }</div><div class="ttc" id="namespacekaldi_1_1nnet3_html_ac6b64008b19bbb6e8769769cbf96fa68"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ac6b64008b19bbb6e8769769cbf96fa68">kaldi::nnet3::DescriptorTokenize</a></div><div class="ttdeci">bool DescriptorTokenize(const std::string &amp;input, std::vector&lt; std::string &gt; *tokens)</div><div class="ttdoc">This function tokenizes input when parsing Descriptor configuration values. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-parse_8cc_source.html#l00377">nnet-parse.cc:377</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ModelCollapser_html_ae6b2732bea7ce47719f18ad2b06d81d2"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ModelCollapser.html#ae6b2732bea7ce47719f18ad2b06d81d2">kaldi::nnet3::ModelCollapser::nnet_</a></div><div class="ttdeci">Nnet * nnet_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l02003">nnet-utils.cc:2003</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_ad535f900dadd2cbd357d0b6382a9bff6"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#ad535f900dadd2cbd357d0b6382a9bff6">kaldi::nnet3::Nnet::GetNodeNames</a></div><div class="ttdeci">const std::vector&lt; std::string &gt; &amp; GetNodeNames() const</div><div class="ttdoc">returns vector of node names (needed by some parsing code, for instance). </div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00063">nnet-nnet.cc:63</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a74229f66155b91205418f6cbffab377b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74229f66155b91205418f6cbffab377b">&#9670;&nbsp;</a></span>SumDescriptorIsCollapsible()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int32 SumDescriptorIsCollapsible </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1nnet3_1_1SumDescriptor.html">SumDescriptor</a> &amp;&#160;</td>
          <td class="paramname"><em>sum_desc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-utils_8cc_source.html#l01431">1431</a> of file <a class="el" href="nnet-utils_8cc_source.html">nnet-utils.cc</a>.</p>

<p class="reference">References <a class="el" href="nnet-descriptor_8cc_source.html#l00096">SimpleForwardingDescriptor::GetNodeDependencies()</a>, <a class="el" href="nnet-descriptor_8h_source.html#l00199">OffsetForwardingDescriptor::Src()</a>, and <a class="el" href="nnet-descriptor_8h_source.html#l00442">SimpleSumDescriptor::Src()</a>.</p>
<div class="fragment"><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;                                                                  {</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    <span class="comment">// I don&#39;t much like having to use dynamic_cast here.</span></div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;    <span class="keyword">const</span> SimpleSumDescriptor *ss = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>SimpleSumDescriptor*<span class="keyword">&gt;</span>(</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;        &amp;sum_desc);</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    <span class="keywordflow">if</span> (ss == NULL) <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    <span class="keyword">const</span> ForwardingDescriptor *fd = &amp;(ss-&gt;Src());</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    <span class="keyword">const</span> OffsetForwardingDescriptor *od =</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;        <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>OffsetForwardingDescriptor*<span class="keyword">&gt;</span>(fd);</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    <span class="keywordflow">if</span> (od != NULL)</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;      fd = &amp;(od-&gt;Src());</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    <span class="keyword">const</span> SimpleForwardingDescriptor *sd =</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;        <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>SimpleForwardingDescriptor*<span class="keyword">&gt;</span>(fd);</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    <span class="keywordflow">if</span> (sd == NULL) <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;      <span class="comment">// the following is a rather roundabout way to get the node-index from a</span></div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;      <span class="comment">// SimpleForwardingDescriptor, but it works (it avoids adding other stuff</span></div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;      <span class="comment">// to the interface).</span></div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;      std::vector&lt;int32&gt; v;</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;      sd-&gt;GetNodeDependencies(&amp;v);</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;      int32 node_index = v[0];</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;      <span class="keywordflow">return</span> node_index;</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    }</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;  }</div></div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a1dce8d84995d048f91d9ec9b1d8e874c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1dce8d84995d048f91d9ec9b1d8e874c">&#9670;&nbsp;</a></span>config_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structkaldi_1_1nnet3_1_1CollapseModelConfig.html">CollapseModelConfig</a>&amp; config_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-utils_8cc_source.html#l02002">2002</a> of file <a class="el" href="nnet-utils_8cc_source.html">nnet-utils.cc</a>.</p>

</div>
</div>
<a id="ae6b2732bea7ce47719f18ad2b06d81d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6b2732bea7ce47719f18ad2b06d81d2">&#9670;&nbsp;</a></span>nnet_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a>* nnet_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-utils_8cc_source.html#l02003">2003</a> of file <a class="el" href="nnet-utils_8cc_source.html">nnet-utils.cc</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>nnet3/<a class="el" href="nnet-utils_8cc_source.html">nnet-utils.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacekaldi.html">kaldi</a></li><li class="navelem"><a class="el" href="namespacekaldi_1_1nnet3.html">nnet3</a></li><li class="navelem"><a class="el" href="classkaldi_1_1nnet3_1_1ModelCollapser.html">ModelCollapser</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
